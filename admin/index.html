<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin | MBW Dashboards</title>
  <meta name="robots" content="noindex, nofollow" />
  <meta name="theme-color" content="#034EA2" />
  <link rel="canonical" href="https://admin.mindobirdwatching.com/" />

  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">

  <link rel="stylesheet" href="/assets/css/site.css">
  <link rel="stylesheet" href="/assets/css/header.css?v=1">
  <script src="/assets/js/head.js" defer></script>

  <style>
    :root{
      --brand: #034EA2;
      --ink: #0b1220;
      --muted: rgba(11, 18, 32, 0.62);
      --line: rgba(11, 18, 32, 0.10);
      --card: rgba(255,255,255,0.78);
      --bg: #f6f8fb;
      --shadow: 0 10px 26px rgba(3, 78, 162, 0.10);
      --shadow2: 0 18px 60px rgba(11, 18, 32, 0.16);
      --r: 16px;
      --r2: 22px;
      --max: 1180px;
    }

    html, body { height: 100%; }
    body { background: var(--bg); overflow-x: hidden; }

    .wrap { max-width: var(--max); margin: 0 auto; padding: 18px 14px 34px; }
    .card { background: var(--card); border: 1px solid var(--line); border-radius: var(--r2); box-shadow: var(--shadow); }
    .topbar {
      position: sticky;
      top: 12px;
      z-index: 20;
      padding: 14px;
      margin-bottom: 14px;
      backdrop-filter: blur(10px);
    }

    .topbarInner{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .titleBlock{ display:flex; align-items:flex-start; gap: 12px; }
    .titleBlock .dot{
      width: 10px; height: 10px; border-radius: 99px;
      background: var(--brand);
      margin-top: 7px;
      box-shadow: 0 0 0 4px rgba(3,78,162,0.12);
    }

    h1{ font-size: 18px; margin: 0; letter-spacing: -0.02em; }
    .sub{ margin-top: 4px; font-size: 12.5px; color: var(--muted); }
    .badge{
      display:inline-flex; align-items:center; gap: 8px;
      padding: 6px 10px; border-radius: 999px;
      border: 1px solid rgba(3,78,162,0.22);
      background: rgba(3,78,162,0.08);
      font-weight: 900; font-size: 12px; color: var(--ink);
      white-space: nowrap;
    }
    .badge i{ display:inline-block; width: 6px; height: 6px; border-radius: 99px; background: var(--brand); }

    .controls{ display:flex; align-items:center; gap: 10px; flex-wrap: wrap; }
    .seg{
      display:flex; align-items:center;
      border: 1px solid var(--line);
      border-radius: 999px;
      background: rgba(255,255,255,0.65);
      box-shadow: 0 8px 18px rgba(3, 78, 162, 0.08);
      overflow: hidden;
    }
    .seg button{
      appearance: none; border: 0; background: transparent;
      padding: 10px 12px;
      font-weight: 950; font-size: 13px;
      color: var(--ink);
      cursor: pointer;
      white-space: nowrap;
    }
    .seg button[aria-pressed="true"]{
      background: rgba(3,78,162,0.12);
      color: var(--ink);
    }
    .pill{
      display:inline-flex; align-items:center; gap: 8px;
      border: 1px solid var(--line);
      border-radius: 999px;
      background: rgba(255,255,255,0.65);
      box-shadow: 0 8px 18px rgba(3, 78, 162, 0.08);
      padding: 8px 10px;
    }
    .pill label{ font-size: 12px; font-weight: 900; color: var(--muted); }
    .pill select{
      border: 0; background: transparent;
      font-weight: 900; font-size: 13px;
      outline: none;
      color: var(--ink);
      cursor: pointer;
    }

    .btn{
      appearance:none; border: 1px solid rgba(3,78,162,0.22);
      background: rgba(3,78,162,0.10);
      color: var(--ink);
      padding: 10px 12px;
      border-radius: 999px;
      font-weight: 950;
      cursor:pointer;
      white-space: nowrap;
      box-shadow: 0 10px 22px rgba(3, 78, 162, 0.10);
    }
    .btn:hover{ background: rgba(3,78,162,0.14); }

    .contentCard{ padding: 14px; }
    .panelHeader{
      display:flex; align-items:flex-start; justify-content:space-between; gap: 10px; flex-wrap: wrap;
      margin-bottom: 10px;
    }
    .panelHeader .h{
      font-size: 14px; font-weight: 950; letter-spacing: -0.01em; margin: 0;
    }
    .panelHeader .p{
      font-size: 12.5px; margin: 4px 0 0; color: var(--muted);
    }
    .panelHeader a{
      font-size: 12.5px; font-weight: 950;
      color: var(--brand);
      text-decoration: none;
      white-space: nowrap;
    }
    .panelHeader a:hover{ text-decoration: underline; }

    .frames{ position: relative; }
    .frameBox{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,0.70);
      box-shadow: var(--shadow);
      overflow: hidden;
      height: min(78vh, 920px);
    }
    iframe{ width: 100%; height: 100%; border: 0; display:block; }

    .framePane{ display:none; }
    .framePane.active{ display:block; animation: fadeIn 160ms ease-out; }
    @keyframes fadeIn { from { opacity: 0.01; transform: translateY(2px); } to { opacity: 1; transform: translateY(0); } }

    /* Drawer */
    .drawerScrim{
      position: fixed; inset: 0;
      background: rgba(11,18,32,0.36);
      backdrop-filter: blur(2px);
      display:none;
      z-index: 50;
    }
    .drawer{
      position: fixed;
      top: 0; right: 0;
      width: min(420px, 92vw);
      height: 100%;
      background: #ffffff;
      border-left: 1px solid rgba(11, 18, 32, 0.12);
      box-shadow: var(--shadow2);
      transform: translateX(100%);
      transition: transform 180ms ease-out;
      z-index: 60;
      display:flex;
      flex-direction: column;
    }
    .drawerScrim.open{ display:block; }
    .drawer.open{ transform: translateX(0); }

    .drawerTop{
      padding: 14px 14px 10px;
      border-bottom: 1px solid rgba(11, 18, 32, 0.10);
      display:flex; align-items:center; justify-content:space-between; gap: 10px;
    }
    .drawerTop .t{ font-weight: 950; letter-spacing: -0.01em; }
    .iconBtn{
      appearance:none; border: 1px solid rgba(11, 18, 32, 0.12);
      background: rgba(11,18,32,0.04);
      border-radius: 12px;
      padding: 8px 10px;
      cursor:pointer;
      font-weight: 950;
    }
    .drawerBody{ padding: 14px; overflow: auto; }
    .sect{ margin-bottom: 14px; }
    .sect h3{ font-size: 13px; margin: 0 0 8px; font-weight: 950; }
    .help{ font-size: 12.5px; color: var(--muted); margin: 0 0 10px; }

    .grid2{ display:grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .field{
      border: 1px solid rgba(11, 18, 32, 0.12);
      border-radius: 14px;
      padding: 10px;
      background: rgba(246, 248, 251, 0.75);
    }
    .field label{ display:block; font-size: 12px; font-weight: 950; color: var(--muted); margin-bottom: 6px; }
    .field select, .field input{
      width: 100%;
      border: 1px solid rgba(11, 18, 32, 0.12);
      border-radius: 12px;
      padding: 9px 10px;
      font-weight: 900;
      outline: none;
      background: #fff;
    }

    .drawerBottom{
      padding: 12px 14px;
      border-top: 1px solid rgba(11, 18, 32, 0.10);
      display:flex; gap: 10px; justify-content: flex-end; flex-wrap: wrap;
      background: rgba(255,255,255,0.92);
    }
    .btn2{
      appearance:none; border: 1px solid rgba(11,18,32,0.12);
      background: rgba(11,18,32,0.04);
      color: var(--ink);
      padding: 10px 12px;
      border-radius: 999px;
      font-weight: 950;
      cursor:pointer;
      white-space: nowrap;
    }
    .btnPrimary{
      border-color: rgba(3,78,162,0.22);
      background: rgba(3,78,162,0.12);
    }

    /* Hover quick switch */
    .quickSwitch{
      position: fixed;
      right: 14px;
      bottom: 14px;
      z-index: 30;
    }
    .fab{
      width: 46px; height: 46px;
      border-radius: 16px;
      border: 1px solid rgba(3,78,162,0.22);
      background: rgba(255,255,255,0.92);
      box-shadow: var(--shadow2);
      cursor: pointer;
      display:flex; align-items:center; justify-content:center;
      font-weight: 950;
      color: var(--brand);
    }
    .fabMenu{
      position: absolute;
      right: 0;
      bottom: 54px;
      width: 220px;
      border-radius: 16px;
      border: 1px solid rgba(11,18,32,0.10);
      background: rgba(255,255,255,0.96);
      box-shadow: var(--shadow2);
      padding: 8px;
      display:none;
    }
    .quickSwitch:hover .fabMenu{ display:block; }
    .fabItem{
      display:flex; align-items:center; justify-content:space-between;
      gap: 10px;
      padding: 10px 10px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 950;
      color: var(--ink);
    }
    .fabItem:hover{ background: rgba(3,78,162,0.08); }
    .fabItem small{ font-weight: 900; color: var(--muted); }

    @media (max-width: 720px){
      .frameBox{ height: 74vh; }
      .topbar{ top: 0; border-radius: 0; }
      .card.topbar{ border-radius: 0; }
    }
  </style>
</head>

<body>
  <div id="siteHeader"></div>

  <div class="wrap">
    <div class="card topbar" aria-label="Admin controls">
      <div class="topbarInner">
        <div class="titleBlock">
          <span class="dot" aria-hidden="true"></span>
          <div>
            <h1>MBW Admin</h1>
            <div class="sub">
              Private dashboards for KPIs, site, and social media. Data updates per connected sources.
              <span class="badge" style="margin-left:8px;"><i aria-hidden="true"></i> Admin only</span>
            </div>
          </div>
        </div>

        <div class="controls">
          <div class="seg" role="group" aria-label="View selector">
            <button type="button" data-view="kpis" aria-pressed="true">KPIs</button>
            <button type="button" data-view="site" aria-pressed="false">Site</button>
            <button type="button" data-view="social" aria-pressed="false">Social Media</button>
          </div>

          <div class="pill" aria-label="Date preset">
            <label for="datePreset">Date</label>
            <select id="datePreset">
              <option value="all">All time</option>
              <option value="30" selected>Last 30 days</option>
              <option value="7">Last 7 days</option>
              <option value="mt">This month</option>
              <option value="ytd">Year to date</option>
            </select>
          </div>

          <button class="btn" type="button" id="openFilters">Filters</button>
        </div>
      </div>
    </div>

    <main class="card contentCard" aria-label="Admin dashboards">
      <div class="panelHeader">
        <div>
          <div class="h" id="panelTitle">KPIs</div>
          <div class="p" id="panelDesc">Revenue, margins, fees, tips, payouts, and upcoming tours.</div>
        </div>
        <a href="#" id="openInLooker" target="_blank" rel="noreferrer">Open in Looker</a>
      </div>

      <div class="frames">
        <div class="framePane active" data-pane="kpis">
          <div class="frameBox">
            <iframe id="frameKpis" title="MBW KPIs dashboard" src="" allowfullscreen loading="lazy" referrerpolicy="no-referrer" sandbox="allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"></iframe>
          </div>
        </div>

        <div class="framePane" data-pane="site">
          <div class="frameBox">
            <iframe id="frameSite" title="MBW site performance dashboard" src="" allowfullscreen loading="lazy" referrerpolicy="no-referrer" sandbox="allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"></iframe>
          </div>
        </div>

        <div class="framePane" data-pane="social">
          <div class="frameBox">
            <iframe id="frameSocial" title="MBW social media dashboard" src="" allowfullscreen loading="lazy" referrerpolicy="no-referrer" sandbox="allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"></iframe>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Hover quick switch (optional convenience) -->
  <div class="quickSwitch" aria-label="Quick switch">
    <button class="fab" type="button" aria-label="Quick menu">MBW</button>
    <div class="fabMenu" aria-label="Quick menu items">
      <div class="fabItem" data-quick="kpis"><span>KPIs</span><small>money and tours</small></div>
      <div class="fabItem" data-quick="site"><span>Site</span><small>traffic and conversions</small></div>
      <div class="fabItem" data-quick="social"><span>Social</span><small>Instagram and YouTube</small></div>
      <div class="fabItem" id="quickFilters"><span>Filters</span><small>open panel</small></div>
    </div>
  </div>

  <!-- Drawer -->
  <div class="drawerScrim" id="drawerScrim" aria-hidden="true"></div>
  <aside class="drawer" id="drawer" aria-label="Filters panel" aria-hidden="true">
    <div class="drawerTop">
      <div class="t">Filters</div>
      <button class="iconBtn" type="button" id="closeDrawer" aria-label="Close">Close</button>
    </div>

    <div class="drawerBody">
      <div class="sect">
        <h3>Global</h3>
        <p class="help">These controls reload the embedded dashboards. If a report ignores a setting, it means the report does not expose that control via URL parameters.</p>
        <div class="grid2">
          <div class="field">
            <label for="drawerDatePreset">Date preset</label>
            <select id="drawerDatePreset">
              <option value="all">All time</option>
              <option value="30" selected>Last 30 days</option>
              <option value="7">Last 7 days</option>
              <option value="mt">This month</option>
              <option value="ytd">Year to date</option>
            </select>
          </div>
          <div class="field">
            <label for="timezoneHint">Timezone</label>
            <select id="timezoneHint">
              <option value="local" selected>Browser local</option>
              <option value="utc">UTC</option>
            </select>
          </div>
        </div>
      </div>

      <div class="sect" id="sectKpis">
        <h3>KPIs</h3>
        <div class="grid2">
          <div class="field">
            <label for="kTourStatus">Tour status</label>
            <select id="kTourStatus">
              <option value="all" selected>All</option>
              <option value="completed">Completed</option>
              <option value="pending">Pending</option>
            </select>
          </div>
          <div class="field">
            <label for="kGuidePaid">Guide paid</label>
            <select id="kGuidePaid">
              <option value="all" selected>All</option>
              <option value="yes">Yes</option>
              <option value="no">No</option>
            </select>
          </div>
        </div>
      </div>

      <div class="sect" id="sectSite" style="display:none;">
        <h3>Site</h3>
        <div class="grid2">
          <div class="field">
            <label for="sDevice">Device</label>
            <select id="sDevice">
              <option value="all" selected>All</option>
              <option value="desktop">Desktop</option>
              <option value="mobile">Mobile</option>
              <option value="tablet">Tablet</option>
            </select>
          </div>
          <div class="field">
            <label for="sChannel">Channel</label>
            <select id="sChannel">
              <option value="all" selected>All</option>
              <option value="organic">Organic</option>
              <option value="direct">Direct</option>
              <option value="referral">Referral</option>
              <option value="social">Organic Social</option>
            </select>
          </div>
        </div>
      </div>

      <div class="sect" id="sectSocial" style="display:none;">
        <h3>Social Media</h3>
        <div class="grid2">
          <div class="field">
            <label for="smPlatform">Platform</label>
            <select id="smPlatform">
              <option value="all" selected>All</option>
              <option value="instagram">Instagram</option>
              <option value="youtube">YouTube</option>
            </select>
          </div>
          <div class="field">
            <label for="smMetric">Metric</label>
            <select id="smMetric">
              <option value="all" selected>All</option>
              <option value="views">Views</option>
              <option value="reach">Reach</option>
              <option value="engagement">Engagement</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <div class="drawerBottom">
      <button class="btn2" type="button" id="resetFilters">Reset</button>
      <button class="btn2 btnPrimary" type="button" id="applyFilters">Apply</button>
    </div>
  </aside>

  <div id="siteFooter"></div>

  <script src="/assets/js/includes.js?v=1" defer></script>
  <script src="/assets/js/site.js?v=1" defer></script>

  <script>
    // Paste your Looker Studio embed URLs here.
    // Use the "Embed report" URL (not the share URL).
    // Example format (placeholder): https://lookerstudio.google.com/embed/reporting/REPORT_ID/page/PAGE_ID
    var REPORTS = {
      kpis: "https://lookerstudio.google.com/embed/reporting/e9dd5771-63b2-4349-b33d-d56a2115d866/page/0HvmF",
      site: "https://lookerstudio.google.com/embed/reporting/1a0a112d-05c0-4b42-a55b-c70a9df099d1/page/bdXZF",
      social: "https://lookerstudio.google.com/embed/reporting/f2ce3a28-4438-4143-9fa1-480a9a3747bc/page/MABlF"
    };

    // Optional: open-in-looker links (can be same as embed URLs).
    var REPORT_LINKS = {
      kpis: "https://lookerstudio.google.com/embed/reporting/e9dd5771-63b2-4349-b33d-d56a2115d866/page/0HvmF",
      site: "https://lookerstudio.google.com/embed/reporting/1a0a112d-05c0-4b42-a55b-c70a9df099d1/page/bdXZF",
      social: "https://lookerstudio.google.com/embed/reporting/f2ce3a28-4438-4143-9fa1-480a9a3747bc/page/MABlF"
    };

    var VIEW_META = {
      kpis: {
        title: "KPIs",
        desc: "Revenue, margins, fees, tips, payouts, and upcoming tours."
      },
      site: {
        title: "Site",
        desc: "Website sessions, sources, devices, and conversions."
      },
      social: {
        title: "Social Media",
        desc: "Instagram and YouTube performance snapshots and trends."
      }
    };

    function setPressed(view){
      var btns = document.querySelectorAll(".seg button[data-view]");
      btns.forEach(function(b){
        b.setAttribute("aria-pressed", b.getAttribute("data-view") === view ? "true" : "false");
      });
    }

    function showPane(view){
      document.querySelectorAll(".framePane").forEach(function(p){
        p.classList.toggle("active", p.getAttribute("data-pane") === view);
      });
      var mt = VIEW_META[view] || VIEW_META.kpis;
      document.getElementById("panelTitle").textContent = mt.title;
      document.getElementById("panelDesc").textContent = mt.desc;

      document.getElementById("sectKpis").style.display = (view === "kpis") ? "" : "none";
      document.getElementById("sectSite").style.display = (view === "site") ? "" : "none";
      document.getElementById("sectSocial").style.display = (view === "social") ? "" : "none";

      var link = (REPORT_LINKS[view] || REPORTS[view] || "#");
      var a = document.getElementById("openInLooker");
      a.href = link;
      a.style.visibility = (link && link !== "#") ? "visible" : "hidden";
    }

    function getState(){
      return {
        datePreset: document.getElementById("datePreset").value,
        kTourStatus: document.getElementById("kTourStatus").value,
        kGuidePaid: document.getElementById("kGuidePaid").value,
        sDevice: document.getElementById("sDevice").value,
        sChannel: document.getElementById("sChannel").value,
        smPlatform: document.getElementById("smPlatform").value,
        smMetric: document.getElementById("smMetric").value
      };
    }

    function buildParams(state, view){
      // These params are placeholders for URL-based control. They only work if your Looker reports are configured to read URL parameters.
      // If not configured, the report will ignore these params. The dashboard will still work as a view switcher.
      var p = {};
      p.view = view;
      p.dp = state.datePreset;

      if(view === "kpis"){
        p.tour = state.kTourStatus;
        p.gpaid = state.kGuidePaid;
      }
      if(view === "site"){
        p.device = state.sDevice;
        p.chan = state.sChannel;
      }
      if(view === "social"){
        p.platform = state.smPlatform;
        p.metric = state.smMetric;
      }
      return p;
    }

    function addParams(url, params){
      if(!url) return "";
      var hasQ = url.indexOf("?") >= 0;
      var q = [];
      for(var k in params){
        if(!Object.prototype.hasOwnProperty.call(params, k)) continue;
        q.push(encodeURIComponent(k) + "=" + encodeURIComponent(String(params[k])));
      }
      return url + (hasQ ? "&" : "?") + q.join("&");
    }

    function loadFrames(state){
      var kUrl = addParams(REPORTS.kpis, buildParams(state, "kpis"));
      var sUrl = addParams(REPORTS.site, buildParams(state, "site"));
      var smUrl = addParams(REPORTS.social, buildParams(state, "social"));

      var fk = document.getElementById("frameKpis");
      var fs = document.getElementById("frameSite");
      var fsm = document.getElementById("frameSocial");

      if(kUrl) fk.src = kUrl;
      if(sUrl) fs.src = sUrl;
      if(smUrl) fsm.src = smUrl;
    }

    function openDrawer(){
      document.getElementById("drawerScrim").classList.add("open");
      document.getElementById("drawer").classList.add("open");
      document.getElementById("drawer").setAttribute("aria-hidden", "false");
      document.getElementById("drawerScrim").setAttribute("aria-hidden", "false");
    }

    function closeDrawer(){
      document.getElementById("drawerScrim").classList.remove("open");
      document.getElementById("drawer").classList.remove("open");
      document.getElementById("drawer").setAttribute("aria-hidden", "true");
      document.getElementById("drawerScrim").setAttribute("aria-hidden", "true");
    }

    function syncDrawerFromTop(){
      document.getElementById("drawerDatePreset").value = document.getElementById("datePreset").value;
    }
    function syncTopFromDrawer(){
      document.getElementById("datePreset").value = document.getElementById("drawerDatePreset").value;
    }

    function resetDrawer(){
      document.getElementById("drawerDatePreset").value = "30";
      document.getElementById("timezoneHint").value = "local";
      document.getElementById("kTourStatus").value = "all";
      document.getElementById("kGuidePaid").value = "all";
      document.getElementById("sDevice").value = "all";
      document.getElementById("sChannel").value = "all";
      document.getElementById("smPlatform").value = "all";
      document.getElementById("smMetric").value = "all";
      syncTopFromDrawer();
    }

    function wire(){
      var currentView = "kpis";

      // Tabs
      document.querySelectorAll(".seg button[data-view]").forEach(function(b){
        b.addEventListener("click", function(){
          currentView = b.getAttribute("data-view");
          setPressed(currentView);
          showPane(currentView);
        });
      });

      // Quick hover menu
      document.querySelectorAll(".fabItem[data-quick]").forEach(function(x){
        x.addEventListener("click", function(){
          currentView = x.getAttribute("data-quick");
          setPressed(currentView);
          showPane(currentView);
        });
      });
      document.getElementById("quickFilters").addEventListener("click", function(){
        syncDrawerFromTop();
        openDrawer();
      });

      // Drawer
      document.getElementById("openFilters").addEventListener("click", function(){
        syncDrawerFromTop();
        openDrawer();
      });
      document.getElementById("closeDrawer").addEventListener("click", closeDrawer);
      document.getElementById("drawerScrim").addEventListener("click", closeDrawer);

      document.getElementById("resetFilters").addEventListener("click", function(){
        resetDrawer();
      });

      document.getElementById("applyFilters").addEventListener("click", function(){
        syncTopFromDrawer();
        var state = getState();
        loadFrames(state);
        closeDrawer();
      });

      document.getElementById("datePreset").addEventListener("change", function(){
        // Apply immediately for convenience
        var state = getState();
        loadFrames(state);
      });

      // Initial
      setPressed(currentView);
      showPane(currentView);
      resetDrawer();
      loadFrames(getState());
    }

    document.addEventListener("DOMContentLoaded", wire);
  </script>
</body>
</html>
