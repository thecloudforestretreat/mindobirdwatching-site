<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Private Birding Tours in Mindo, Ecuador | Mindo Bird Watching</title>
  <meta name="description" content="Private birding tours in Mindo, Ecuador with expert bilingual guides, flexible pacing, and simple planning for unforgettable cloud forest wildlife." />
  <!-- Canonical + hreflang (PRODUCTION URLs) -->
  <link rel="canonical" href="https://mindobirdwatching.com/" />
  <link rel="alternate" hreflang="en" href="https://mindobirdwatching.com/" />
  <link rel="alternate" hreflang="es" href="https://mindobirdwatching.com/es/" />
  <link rel="alternate" hreflang="x-default" href="https://mindobirdwatching.com/" />
  <!-- Open Graph (PRODUCTION URLs) -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Mindo Bird Watching" />
  <meta property="og:title" content="Private Birding Tours in Mindo, Ecuador | Mindo Bird Watching" />
  <meta property="og:description" content="Private birding tours in Mindo, Ecuador with expert bilingual guides, flexible pacing, and simple planning for unforgettable cloud forest wildlife." />
  <meta property="og:url" content="https://mindobirdwatching.com/" />
  <meta property="og:image" content="https://mindobirdwatching.com/MBW-Assets-OG-Image.jpg" />
  <meta property="og:image:secure_url" content="https://mindobirdwatching.com/MBW-Assets-OG-Image.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="Mindo Bird Watching featured image" />
  <!-- Twitter (PRODUCTION URLs) -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Private Birding Tours in Mindo, Ecuador | Mindo Bird Watching" />
  <meta name="twitter:description" content="Private birding tours in Mindo, Ecuador with expert bilingual guides, flexible pacing, and simple planning for unforgettable cloud forest wildlife." />
  <meta name="twitter:image" content="https://mindobirdwatching.com/MBW-Assets-OG-Image.jpg" />
  <!-- Favicons (approved root paths) -->
  <link rel="icon" href="/favicon.ico" sizes="any" />
  <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <meta name="theme-color" content="#034EA2" />
  <!-- Global / shared CSS -->
  <link rel="stylesheet" href="/assets/css/site.css" />
  <link rel="stylesheet" href="/assets/css/header.css?v=1" />
  <!-- Head-only JS -->
  <script src="/assets/js/head.js" defer></script>
  <style>
    /* =========================
       Page-only styles (main content only)
       ========================= */

    .page { margin-top: 18px; padding: 26px; }
    .page.card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--r);
      box-shadow: var(--shadow);
    }

    /* Mobile-only hero image (under header, hidden on desktop) */
    .mobileHero{
      display: none;
      margin-top: 12px;
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    .mobileHeroFrame{
      width: 100%;
      aspect-ratio: 16 / 9;
      background: rgba(255,255,255,.55);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .mobileHeroFrame img{
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    @media (max-width: 900px){
      .mobileHero{ display: block; }
    }

    /* Above-the-fold ordering: Desktop shows weather first, Mobile shows intro first */
    .aboveFold{
      display:flex;
      flex-direction: column;
      gap: 16px;
    }
    .aboveFold .wx{ order: 1; }
    .aboveFold .hero{ order: 2; }
    @media (max-width: 900px){
      .aboveFold .hero{ order: 1; }
      .aboveFold .wx{ order: 2; }
    }

    /* Weather card (8 cards total: 1 current + 7 days) */
    .wx{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      padding: 14px;
      margin: 0;
    }

    .wxGrid{
      display:grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 10px;
      align-items: stretch;
    }

    .wxDay{
      border: 1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.55);
      box-shadow: var(--shadow);
      padding: 10px;
      display:flex;
      flex-direction: column;
      gap: 10px;
      min-width: 0;
    }

    .wxDayTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 8px;
      min-width: 0;
    }

    .wxDow{
      font-weight: 900;
      font-size: 12.5px;
      color: var(--ink);
      letter-spacing: -0.01em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Current card header: pin + Mindo */
    .wxPlace{
      display:inline-flex;
      align-items:center;
      gap: 2px;
      min-width: 0;
      font-weight: 900;
      font-size: 12.5px;
      color: var(--ink);
      letter-spacing: -0.01em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Desktop-only: remove spacing between pin and "Mindo" */
    @media (min-width: 901px){
      .wxPlace{ gap: 0; }
    }

    .wxPinDot{
      font-size: 14px;
      line-height: 1;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      transform: translateY(-0.5px);
    }

    /* Temps block (no second icon on the right) */
    .wxTempsRow{
      display:block;
      min-width: 0;
    }

    .wxTempsLines{
      min-width: 0;
    }

    .wxLine{
      font-weight: 900;
      font-size: 12.5px;
      color: var(--ink);
      letter-spacing: -0.01em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      line-height: 1.25;
    }

    .wxIcon{
      font-size: 18px;
      line-height: 1;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      min-width: 22px;
      flex: 0 0 auto;
    }

    /* Center the rain line (droplet + text) */
    .wxRain{
      font-weight: 900;
      font-size: 12.5px;
      color: var(--muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 6px;
      text-align:center;
    }

    .wxNote{
      margin: 10px 0 0;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.5;
    }

    .wxNote[hidden]{ display:none; }

    .wxSkeleton .wxDay{
      position: relative;
      overflow: hidden;
    }

    .wxSkeleton .wxDay:before{
      content:"";
      position:absolute;
      inset:-40% -60%;
      background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.55), rgba(255,255,255,0));
      transform: translateX(-40%);
      animation: wxShimmer 1.35s linear infinite;
      pointer-events:none;
    }

    @keyframes wxShimmer{
      0%{ transform: translateX(-40%); }
      100%{ transform: translateX(40%); }
    }

    .hero{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 16px;
      align-items: start;
    }

    .hero h1{
      margin: 0 0 10px;
      letter-spacing: -0.02em;
      line-height: 1.05;
    }

    .hero p{
      margin: 0;
      color: var(--ink);
      line-height: 1.75;
      max-width: 85ch;
    }

    .heroCtas{
      margin-top: 14px;
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items:center;
    }

    .heroAside{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      padding: 14px;
    }

    .heroAside h2{
      margin:0 0 10px;
      font-family: var(--font-head);
      color: var(--forest);
      letter-spacing: -0.02em;
      font-size: 18px;
    }

    .heroList{
      margin: 0;
      padding-left: 18px;
      color: var(--ink);
      line-height: 1.7;
    }

    .section{
      margin-top: 18px;
      padding-top: 14px;
      border-top: 1px solid var(--line);
    }

    .sectionHead{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .sectionHead h2{
      margin:0;
      font-family: var(--font-head);
      color: var(--forest);
      letter-spacing: -0.02em;
      font-size: 20px;
    }

    .hint{
      margin:0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.5;
    }

    /* CTA band */
    .ctaBand{
      margin-top: 14px;
      border: 1px dashed rgba(13,89,37,.35);
      border-radius: 16px;
      background: rgba(255,255,255,.55);
      padding: 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      flex-wrap: wrap;
    }

    .ctaBand p{
      margin:0;
      color: var(--ink);
      line-height: 1.6;
    }

    /* Secure badge card */
    .secureCard{
      margin-top: 14px;
      border: 1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.55);
      box-shadow: var(--shadow);
      padding: 14px;
      display:flex;
      gap: 14px;
      align-items:center;
      width: 100%;
    }

    .secureImg{
      width: 210px;
      height: 210px;
      flex: 0 0 auto;
      border-radius: 22px;
      background: rgba(255,255,255,.55);
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      border: 1px solid var(--line);
    }

    .secureImg img{
      width: 100%;
      height: 100%;
      object-fit: contain;
      display:block;
    }

    .secureCopy{
      min-width: 0;
    }

    .secureKicker{
      margin: 0 0 6px;
      font-weight: 900;
      letter-spacing: -0.01em;
      color: var(--ink);
      font-size: 15px;
      line-height: 1.2;
    }

    .secureText{
      margin: 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.6;
    }

    /* Image + video blocks */
    .mediaGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
      align-items: start;
    }

    .mediaCol{
      display:flex;
      flex-direction: column;
      gap: 14px;
      align-items: stretch;
      min-width: 0;
    }

    .mediaCard{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .mediaFrame{
      width:100%;
      aspect-ratio: 16 / 10;
      background: rgba(255,255,255,.55);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
    }

    .mediaFrame img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }

    .videoFrame{
      width:100%;
      aspect-ratio: 9 / 16;
      border:0;
      display:block;
      background: rgba(255,255,255,.55);
    }

    .mediaBar{
      padding: 10px 12px;
      border-top: 1px solid var(--line);
      background: rgba(255,255,255,.55);
      display:flex;
      justify-content:space-between;
      gap: 10px;
      flex-wrap: wrap;
      align-items:center;
    }

    .mediaTitle{
      margin:0;
      font-weight: 900;
      color: var(--ink);
      font-size: 13.5px;
      letter-spacing: -0.01em;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      font-weight: 900;
      font-size: 12.5px;
      color: var(--ink);
      line-height: 1;
      white-space: nowrap;
    }

    /* Quick links */
    .tiles{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }

    .tile{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      padding: 14px;
      text-decoration:none;
      color: inherit;
      display:block;
      min-height: 120px;
    }

    .tile h3{
      margin:0 0 6px;
      font-family: var(--font-head);
      color: var(--forest);
      letter-spacing: -0.01em;
      font-size: 16.5px;
    }

    .tile p{
      margin:0;
      color: var(--ink);
      line-height: 1.65;
    }

    .tile .sub{
      margin-top: 10px;
      color: var(--muted);
      font-size: 12.5px;
    }

    /* Small photo rail */
    .photoRail{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
    }

    .photo{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .photo img{
      width:100%;
      height: 170px;
      object-fit: cover;
      display:block;
      background: rgba(255,255,255,.55);
    }

    .photoCap{
      padding: 10px 12px;
      border-top: 1px solid var(--line);
      background: rgba(255,255,255,.55);
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.45;
    }

    /* Breakpoints */
    @media (max-width: 1180px){
      .wxGrid{ grid-template-columns: repeat(4, 1fr); }
    }

    @media (max-width: 980px){
      .photoRail{ grid-template-columns: repeat(2, 1fr); }
      .photo img{ height: 180px; }
    }

    @media (max-width: 900px){
      .hero{ grid-template-columns: 1fr; }
      .mediaGrid{ grid-template-columns: 1fr; }
      .tiles{ grid-template-columns: 1fr; }
      .photoRail{ grid-template-columns: 1fr; }
      .photo img{ height: 220px; }

      .secureCard{
        align-items: flex-start;
      }
      .secureImg{
        width: 152px;
        height: 152px;
      }

      /* Mobile: 8 cards total -> 2 columns -> 4 rows */
      .wxGrid{ grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Shared header mount -->
    <div id="siteHeader"></div>
<!-- Mobile-only hero image (shows only on mobile, under header) -->
<section class="mobileHero" aria-label="Mobile hero image">
  <div class="mobileHeroFrame">
    <img src="/assets/images/pages/MBW-Assets_Hero_Mobile.jpg" alt="Birdwatching in Mindo cloud forest" loading="eager" decoding="async" />
  </div>
</section>

<main class="page card" aria-label="Mindo Bird Watching home">
  <div class="aboveFold">
    <!-- HERO -->
    <section class="hero" aria-label="Intro">
      <div>
        <h1>Private birdwatching in Mindo, Ecuador</h1>
        <p>
          Explore the cloud forest with expert bilingual guides. Simple planning, flexible pacing, and the best chances to
          see toucans, hummingbirds, tanagers, and the iconic Andean Cock-of-the-Rock.
        </p>

        <div class="heroCtas" aria-label="Primary actions">
          <a class="btn secondary" href="/tours/">View Tours</a>
          <a class="btn primary" href="/book-tour/">Book A Tour</a>
          <a class="btn secondary" href="/bird-gallery/">Bird Gallery</a>
        </div>

        <div class="ctaBand" aria-label="Quick reassurance">
          <p><strong>New to birding?</strong> No problem. We guide beginners and serious birders, and we keep the experience calm and organized.</p>
          <a class="btn secondary" href="/faqs/">Read FAQs</a>
        </div>
      </div>

      <aside class="heroAside" aria-label="Highlights">
        <h2>Why Guests Love Mindo</h2>
        <ul class="heroList">
          <li>Early starts that maximize sightings</li>
          <li>Local spots chosen by season and weather</li>
          <li>Binoculars and scope support when needed</li>
          <li>Great for families, photographers, and groups</li>
        </ul>

        <div class="secureCard" aria-label="Safe and secure travel">
          <div class="secureImg" aria-hidden="true">
            <img src="/assets/images/MBW-Assets-4-SecureBadge.png" alt="Safe and secure travel badge" />
          </div>
          <div class="secureCopy">
            <p class="secureKicker">Safe and secure travel</p>
            <p class="secureText">
              Tours are well planned, calm, and organized with clear meeting points, trusted local logistics, and guidance every step of the way.
            </p>
          </div>
        </div>
      </aside>
    </section>

    <!-- WEATHER (8 cards: current + 7-day) -->
    <section class="wx wxSkeleton" aria-label="Weather">
      <div class="wxGrid" id="wxGrid" aria-label="Current + 7-day forecast">
        <!-- Skeleton placeholders (8) -->
        <div class="wxDay">
          <div class="wxDayTop">
            <span class="wxDow">--</span>
            <span class="wxIcon" aria-hidden="true">üå•Ô∏è</span>
          </div>
          <div class="wxTempsRow">
            <div class="wxTempsLines">
              <div class="wxLine">-- C / -- F</div>
              <div class="wxLine">-- C / -- F</div>
            </div>
          </div>
          <div class="wxRain"><span aria-hidden="true">üíß</span><span>-- mm</span></div>
        </div>
        <div class="wxDay"></div>
        <div class="wxDay"></div>
        <div class="wxDay"></div>
        <div class="wxDay"></div>
        <div class="wxDay"></div>
        <div class="wxDay"></div>
        <div class="wxDay"></div>
      </div>

      <p class="wxNote" id="wxNote" hidden> </p>
    </section>
  </div>

  <!-- FEATURE MEDIA: IMAGES + VIDEO -->
  <section class="section" aria-label="Featured media">
    <div class="sectionHead">
      <h2>See What The Experience Feels Like</h2>
      <p class="hint"></p>
    </div>

    <div class="mediaGrid">
      <div class="mediaCol" aria-label="Featured images">
        <article class="mediaCard" aria-label="Featured image 1">
          <div class="mediaFrame">
            <img src="/assets/images/pages/home/MBW-Assets-homepage-top.jpg" alt="Birdwatching in the Mindo cloud forest" />
          </div>
          <div class="mediaBar">
            <p class="mediaTitle">Cloud Forest Birding</p>
            <span class="badge">Mindo</span>
          </div>
        </article>

        <article class="mediaCard" aria-label="Featured image 2">
          <div class="mediaFrame">
            <img src="/assets/images/pages/home/MBW-Assets-homepage-top-2.jpg" alt="Birding trail and scenic cloud forest views in Mindo" />
          </div>
          <div class="mediaBar">
            <p class="mediaTitle">Local Trails and Views</p>
            <span class="badge">Guided</span>
          </div>
        </article>
      </div>

      <div class="mediaCol" aria-label="Video">
        <article class="mediaCard" aria-label="Featured video">
          <iframe
            class="videoFrame"
            src="https://www.youtube.com/embed/bfVgotdkJPE?rel=0"
            title="Spotting the Elusive Umbrellabird in Mindo, Ecuador!"
            loading="lazy"
            referrerpolicy="strict-origin-when-cross-origin"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen></iframe>
          <div class="mediaBar">
            <p class="mediaTitle">Spotting the Umbrellabird</p>
            <span class="badge">YouTube Short</span>
          </div>
        </article>
      </div>
    </div>
  </section>

  <!-- QUICK LINKS -->
  <section class="section" aria-label="Explore sections">
    <div class="sectionHead">
      <h2>Explore The Site</h2>
      <p class="hint"></p>
    </div>

    <div class="tiles" aria-label="Quick links grid">
      <a class="tile" href="/tours/" aria-label="Explore tours">
        <h3>Tours</h3>
        <p>Half-day, full-day, and custom private tours.</p>
        <p class="sub">See options and what is included</p>
      </a>

      <a class="tile" href="/bird-of-the-week/" aria-label="Bird of the week">
        <h3>Bird of the Week</h3>
        <p>Featured species, quick facts, and calls to learn.</p>
        <p class="sub">Perfect for trip prep</p>
      </a>

      <a class="tile" href="/bird-gallery/" aria-label="Bird gallery">
        <h3>Bird Gallery</h3>
        <p>Browse local species you may spot in Mindo.</p>
        <p class="sub">Great for beginners</p>
      </a>
    </div>
  </section>

  <!-- PHOTO RAIL -->
  <section class="section" aria-label="Highlights">
    <div class="sectionHead">
      <h2>Highlights</h2>
      <p class="hint"></p>
    </div>

    <div class="photoRail" aria-label="Photo highlights grid">
      <figure class="photo" aria-label="Highlight 1">
        <img src="/assets/images/pages/home/MBW-Assets-homepage-bottom-1.jpg" alt="Birding highlights in Mindo" loading="lazy" />
        <figcaption class="photoCap">Birding moments</figcaption>
      </figure>

      <figure class="photo" aria-label="Highlight 2">
        <img src="/assets/images/pages/home/MBW-Assets-homepage-bottom-2.jpg" alt="Cloud forest trails in Mindo" loading="lazy" />
        <figcaption class="photoCap">Cloud forest trails</figcaption>
      </figure>

      <figure class="photo" aria-label="Highlight 3">
        <img src="/assets/images/pages/home/MBW-Assets-homepage-bottom-3.jpg" alt="Hummingbirds in Mindo" loading="lazy" />
        <figcaption class="photoCap">Hummingbirds and feeders</figcaption>
      </figure>

      <figure class="photo" aria-label="Highlight 4">
        <img src="/assets/images/pages/home/MBW-Assets-homepage-bottom-4.jpg" alt="Waterfalls and nature near Mindo" loading="lazy" />
        <figcaption class="photoCap">Waterfalls and nature</figcaption>
      </figure>
    </div>
  </section>
</main>

<!-- Shared footer mount -->
<div id="siteFooter"></div>
  </div>
  <!-- Include injector + site behavior at bottom -->
  <script src="/assets/js/includes.js?v=1" defer></script>
  <script src="/assets/js/site.js?v=1" defer></script>
  <script>
    (function(){
      "use strict";

      var LAT = -0.0516;
      var LON = -78.7764;

      var CACHE_KEY = "mbw_wx_mindo_v2";
      var CACHE_TTL_MS = 60 * 60 * 1000;

      var elGrid = document.getElementById("wxGrid");
      var elNote = document.getElementById("wxNote");

      function cToF(c){ return (c * 9 / 5) + 32; }
      function round(n){ return Math.round(n); }
      function safeNum(n){ return (typeof n === "number" && isFinite(n)) ? n : null; }

      function fmtTempLine(c){
        var cc = safeNum(c);
        if (cc === null) return "-- C / -- F";
        var ff = cToF(cc);
        return round(cc) + " C / " + round(ff) + " F";
      }

      function fmtMm(mm){
        var v = safeNum(mm);
        if (v === null) return "--";
        if (v === 0) return "0";
        if (v < 1) return v.toFixed(1);
        return round(v).toString();
      }

      function dowShort(iso){
        var d = new Date(iso + "T00:00:00");
        if (isNaN(d.getTime())) return "--";
        return d.toLocaleDateString("en-US", { weekday: "short" });
      }

      function iconFromCode(code, mm){
        var c = safeNum(code);
        var r = safeNum(mm);

        if (r !== null && r >= 15) return "‚õàÔ∏è";
        if (r !== null && r >= 6) return "üåßÔ∏è";
        if (r !== null && r > 0) return "üå¶Ô∏è";

        if (c === null) return "üå•Ô∏è";
        if (c === 0) return "‚òÄÔ∏è";
        if (c === 1 || c === 2) return "üå§Ô∏è";
        if (c === 3) return "‚òÅÔ∏è";
        if (c === 45 || c === 48) return "üå´Ô∏è";
        if (c === 51 || c === 53 || c === 55) return "üå¶Ô∏è";
        if (c === 56 || c === 57) return "üåßÔ∏è";
        if (c === 61 || c === 63 || c === 65) return "üåßÔ∏è";
        if (c === 66 || c === 67) return "üåßÔ∏è";
        if (c === 71 || c === 73 || c === 75) return "‚ùÑÔ∏è";
        if (c === 77) return "‚ùÑÔ∏è";
        if (c === 80 || c === 81 || c === 82) return "üåßÔ∏è";
        if (c === 85 || c === 86) return "‚ùÑÔ∏è";
        if (c === 95 || c === 96 || c === 99) return "‚õàÔ∏è";
        return "üå•Ô∏è";
      }

      function setSkeleton(isOn){
        var wx = document.querySelector(".wx");
        if (!wx) return;
        if (isOn) wx.classList.add("wxSkeleton");
        else wx.classList.remove("wxSkeleton");
      }

      function setNote(msg){
        if (!elNote) return;
        if (!msg){
          elNote.hidden = true;
          elNote.textContent = "";
          return;
        }
        elNote.hidden = false;
        elNote.textContent = msg;
      }

      function renderDaily(data){
        try{
          var daily = data && data.daily ? data.daily : null;
          if (!daily) throw new Error("No daily data");

          var tmax = daily.temperature_2m_max || [];
          var tmin = daily.temperature_2m_min || [];
          var psum = daily.precipitation_sum || [];
          var time = daily.time || [];
          var wcode = daily.weathercode || daily.weather_code || [];

          if (!time.length || tmax.length < 7 || tmin.length < 7 || psum.length < 7){
            throw new Error("Insufficient daily arrays");
          }

          var todayMax = tmax[0];
          var todayMin = tmin[0];
          var todayRain = psum[0];
          var todayCode = (wcode && wcode.length) ? wcode[0] : null;
          var todayIcon = iconFromCode(todayCode, todayRain);

          var html = "";

          html += ''
            + '<div class="wxDay wxNow" aria-label="Current weather">'
            +   '<div class="wxDayTop">'
            +     '<span class="wxPlace"><span class="wxPinDot" aria-hidden="true">üìç</span>Mindo</span>'
            +     '<span class="wxIcon" aria-hidden="true">' + todayIcon + '</span>'
            +   '</div>'
            +   '<div class="wxTempsRow">'
            +     '<div class="wxTempsLines">'
            +       '<div class="wxLine">' + fmtTempLine(todayMax) + '</div>'
            +       '<div class="wxLine">' + fmtTempLine(todayMin) + '</div>'
            +     '</div>'
            +   '</div>'
            +   '<div class="wxRain"><span aria-hidden="true">üíß</span><span>' + fmtMm(todayRain) + ' mm</span></div>'
            + '</div>';

          for (var i = 0; i < 7; i++){
            var d = time[i];
            var maxC = tmax[i];
            var minC = tmin[i];
            var mm = psum[i];
            var code = (wcode && wcode.length) ? wcode[i] : null;
            var dayIcon = iconFromCode(code, mm);

            html += ''
              + '<div class="wxDay" aria-label="Forecast day">'
              +   '<div class="wxDayTop">'
              +     '<span class="wxDow">' + dowShort(d) + '</span>'
              +     '<span class="wxIcon" aria-hidden="true">' + dayIcon + '</span>'
              +   '</div>'
              +   '<div class="wxTempsRow">'
              +     '<div class="wxTempsLines">'
              +       '<div class="wxLine">' + fmtTempLine(maxC) + '</div>'
              +       '<div class="wxLine">' + fmtTempLine(minC) + '</div>'
              +     '</div>'
              +   '</div>'
              +   '<div class="wxRain"><span aria-hidden="true">üíß</span><span>' + fmtMm(mm) + ' mm</span></div>'
              + '</div>';
          }

          if (elGrid) elGrid.innerHTML = html;

          setSkeleton(false);
          setNote("");
        }catch(e){
          setSkeleton(false);
          setNote("");
        }
      }

      function readCache(){
        try{
          var raw = localStorage.getItem(CACHE_KEY);
          if (!raw) return null;
          var obj = JSON.parse(raw);
          if (!obj || !obj.ts || !obj.data) return null;
          if ((Date.now() - obj.ts) > CACHE_TTL_MS) return null;
          return obj.data;
        }catch(e){
          return null;
        }
      }

      function writeCache(data){
        try{
          localStorage.setItem(CACHE_KEY, JSON.stringify({ ts: Date.now(), data: data }));
        }catch(e){
          return;
        }
      }

      function fetchWx(){
        var url =
          "https://api.open-meteo.com/v1/forecast"
          + "?latitude=" + encodeURIComponent(LAT)
          + "&longitude=" + encodeURIComponent(LON)
          + "&timezone=auto"
          + "&daily=temperature_2m_max,temperature_2m_min,precipitation_sum,weathercode";

        return fetch(url, { cache: "no-store" }).then(function(r){
          if (!r.ok) throw new Error("Bad response");
          return r.json();
        });
      }

      setSkeleton(true);

      var cached = readCache();
      if (cached){
        renderDaily(cached);
        fetchWx().then(function(data){
          writeCache(data);
          renderDaily(data);
        }).catch(function(){ return; });
      }else{
        fetchWx().then(function(data){
          writeCache(data);
          renderDaily(data);
        }).catch(function(){
          setSkeleton(false);
          setNote("");
        });
      }
    })();
  </script>
</body>
</html>
