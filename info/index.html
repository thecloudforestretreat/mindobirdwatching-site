<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Staff Info | Mindo Bird Watching</title>
  <meta name="robots" content="noindex, nofollow" />
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#034EA2">
  <link rel="stylesheet" href="/assets/css/site.css">
  <link rel="stylesheet" href="/assets/css/header.css?v=1">
  <link rel="stylesheet" href="/assets/css/footer.css">
  <script src="/assets/js/head.js" defer></script>
  <style>
    .page{ margin-top:18px; padding:26px; }
    .page.card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--r);
      box-shadow: var(--shadow);
    }
    h1{ margin:0 0 8px; letter-spacing:-0.02em; }
    .lede{ margin:0; max-width: 92ch; color: var(--ink); line-height:1.65; }
    .controls{ margin-top:14px; display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:10px; align-items:stretch; }
    .pillCtl{
      border: 1px solid var(--line);
      border-radius: 999px;
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      padding: 8px 12px;
      display:flex;
      align-items:center;
      gap:10px;
      height:44px;
      box-sizing:border-box;
      min-width:0;
    }
    .pillCtl label{ font-weight:900; font-size:12.5px; color: var(--muted); white-space:nowrap; }
    .pillCtl select{
      border:0; outline:0; background:transparent; color: var(--ink);
      font-weight:900; width:100%; min-width:0; height:28px; line-height:28px;
    }
    .topActions{ margin-top:12px; display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .topActions .btn{ white-space:nowrap; }
    .layout{ margin-top:16px; display:grid; grid-template-columns: 0.9fr 1.1fr; gap:14px; align-items:start; }
    .panel{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .panelHead{
      padding: 12px 14px;
      border-bottom: 1px solid var(--line);
      background: rgba(255,255,255,.55);
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:baseline;
      flex-wrap:wrap;
    }
    .panelHead h2{ margin:0; font-family: var(--font-head); color: var(--forest); letter-spacing:-0.02em; font-size:18px; }
    .panelHead .hint{ margin:0; color: var(--muted); font-size:12.5px; }
    .panelBody{ padding: 14px; }
    .list{ display:grid; gap:10px; }
    .list button{
      width:100%;
      text-align:left;
      border:1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.55);
      box-shadow: var(--shadow);
      padding: 12px;
      cursor:pointer;
      color: var(--ink);
      font-weight: 900;
      line-height:1.25;
    }
    .list button[aria-current="true"]{
      border-color: rgba(3,78,162,.35);
      box-shadow: 0 0 0 4px rgba(3,78,162,.12);
    }
    .detailTitle{ margin:0; font-family: var(--font-head); color: var(--forest); letter-spacing:-0.02em; font-size:20px; }
    .detailMeta{ margin-top:10px; display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .chip{ display:inline-flex; align-items:center; padding:7px 10px; border-radius:999px; border:1px solid var(--line); background: rgba(255,255,255,.55); font-weight:900; color: var(--ink); font-size:12.5px; line-height:1; white-space:nowrap; }
    .blocks{ margin-top:12px; display:grid; gap:12px; }
    .block{ border:1px solid var(--line); border-radius: 18px; background: rgba(255,255,255,.55); box-shadow: var(--shadow); overflow:hidden; }
    .blockTop{ padding: 10px 12px; border-bottom:1px solid var(--line); background: rgba(255,255,255,.50); display:flex; justify-content:space-between; gap:10px; align-items:center; flex-wrap:wrap; }
    .blockTop strong{ font-size:13px; color: var(--ink); }
    .blockTop .btn{ padding:10px 12px; min-height:40px; border-radius: 12px; }
    .blockBody{ padding: 12px; color: var(--ink); line-height:1.65; white-space:pre-wrap; }
    .imgWrap{ margin-top:12px; border:1px solid var(--line); border-radius: 18px; overflow:hidden; background: rgba(255,255,255,.55); box-shadow: var(--shadow); }
    .imgWrap img{ width:100%; height:auto; display:block; max-height: 380px; object-fit: cover; }
    .imgBar{ padding: 10px 12px; border-top:1px solid var(--line); background: rgba(255,255,255,.55); display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; }
    .imgBar .btn{ padding:10px 12px; min-height:40px; border-radius:12px; }
    .socialGrid{ display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:10px; }
    .socialCard{ border:1px solid var(--line); border-radius: 18px; background: rgba(255,255,255,.55); box-shadow: var(--shadow); padding: 12px; display:flex; align-items:center; gap:10px; justify-content:space-between; }
    .socialLeft{ display:flex; align-items:center; gap:10px; min-width:0; }
    .socialLeft img{ width:28px; height:28px; object-fit:contain; }
    .socialLeft span{ font-weight:900; color: var(--ink); overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
    .toast{ position: fixed; left: 50%; bottom: 18px; transform: translateX(-50%); background: rgba(3,78,162,.92); color:#fff; padding: 10px 12px; border-radius: 999px; font-weight: 900; font-size: 12.5px; box-shadow: 0 14px 40px rgba(0,0,0,.18); display:none; z-index:9999; }

    @media (max-width: 980px){
      .controls{ grid-template-columns: 1fr 1fr; }
      .layout{ grid-template-columns: 1fr; }
      .socialGrid{ grid-template-columns: 1fr; }
      .page{ padding:16px; margin-top:14px; }
      .imgWrap img{ max-height: 320px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="siteHeader"></div>

    <main class="page card" aria-label="MBW staff info">
      <h1 id="pageTitle">Staff Info</h1>
      <p class="lede" id="pageLede">Quick, copy-ready answers for tours, activities, FAQs, and transportation.</p>

      <div class="controls" aria-label="Filters">
        <div class="pillCtl">
          <label for="langSel" id="lblLang">Language</label>
          <select id="langSel">
            <option value="en">English</option>
            <option value="es">Espa√±ol</option>
          </select>
        </div>

        <div class="pillCtl">
          <label for="subjectSel" id="lblSubject">Subject</label>
          <select id="subjectSel"></select>
        </div>

        <div class="pillCtl">
          <label for="topicSel" id="lblTopic">Type</label>
          <select id="topicSel"></select>
        </div>

        <div class="pillCtl" id="itemCtl">
          <label for="itemSel" id="lblItem">Item</label>
          <select id="itemSel"></select>
        </div>
      </div>

      <div class="topActions" aria-label="Top actions">
        <button class="btn primary" id="copyBookBtn" type="button">Copy booking link</button>
      </div>

      <div class="layout" aria-label="Results" id="layoutRoot">
        <section class="panel" aria-label="List" id="listPanel">
          <div class="panelHead">
            <h2 id="listTitle">Items</h2>
            <p class="hint" id="listHint">Select one to view details.</p>
          </div>
          <div class="panelBody">
            <div class="list" id="itemList"></div>
          </div>
        </section>

        <section class="panel" aria-label="Details" id="detailPanel">
          <div class="panelHead">
            <h2 id="detailHead">Details</h2>
            <p class="hint" id="detailHint">Use copy buttons to send fast.</p>
          </div>
          <div class="panelBody" id="detailBody"></div>
        </section>
      </div>
    </main>

    <div id="siteFooter"></div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    (function(){
      "use strict";

      const UI = {
        en: {
          pageTitle: "Staff Info",
          pageLede: "Quick, copy-ready answers for tours, activities, FAQs, and transportation.",
          lang: "Language",
          subject: "Subject",
          topic: "Type",
          item: "Item",
          copyBooking: "Copy booking link",
          listTitle: "Items",
          listHint: "Select one to view details.",
          detailTitle: "Details",
          detailHint: "Use copy buttons to send fast.",
          copy: "Copy",
          copyLink: "Copy link",
          open: "Open",
          short: "Message (short)",
          long: "Message (long)",
          cost: "Cost",
          noData: "No items found for this selection.",
          socials: "Social links",
          copied: "Copied"
        },
        es: {
          pageTitle: "Info para el equipo",
          pageLede: "Respuestas rapidas y listas para copiar sobre tours, actividades, preguntas y transporte.",
          lang: "Idioma",
          subject: "Tema",
          topic: "Tipo",
          item: "Elemento",
          copyBooking: "Copiar link de reserva",
          listTitle: "Elementos",
          listHint: "Selecciona uno para ver detalles.",
          detailTitle: "Detalles",
          detailHint: "Usa copiar para responder rapido.",
          copy: "Copiar",
          copyLink: "Copiar link",
          open: "Abrir",
          short: "Mensaje (corto)",
          long: "Mensaje (largo)",
          cost: "Costo",
          noData: "No hay elementos para esta seleccion.",
          socials: "Redes y enlaces",
          copied: "Copiado"
        }
      };

      const toastEl = document.getElementById("toast");
      function toast(msg){
        if(!toastEl) return;
        toastEl.textContent = msg;
        toastEl.style.display = "block";
        clearTimeout(window.__mbwToastT);
        window.__mbwToastT = setTimeout(function(){ toastEl.style.display = "none"; }, 1400);
      }

      async function copyText(text){
        const t = String(text || "").trim();
        if(!t) return;
        try{
          if(navigator.clipboard && navigator.clipboard.writeText){
            await navigator.clipboard.writeText(t);
            toast(UI[currentLang].copied);
            return;
          }
        }catch(e){}
        try{
          const ta = document.createElement("textarea");
          ta.value = t;
          ta.setAttribute("readonly","readonly");
          ta.style.position = "fixed";
          ta.style.left = "-9999px";
          document.body.appendChild(ta);
          ta.select();
          document.execCommand("copy");
          document.body.removeChild(ta);
          toast(UI[currentLang].copied);
        }catch(e){}
      }

      async function inject(id, url){
        const el = document.getElementById(id);
        if(!el) return;
        const res = await fetch(url, { cache: "no-store" });
        el.innerHTML = await res.text();
      }

      (async function(){
        try{
          await inject("siteHeader", "/assets/includes/header.html");
          await inject("siteFooter", "/assets/includes/footer.html");
        }catch(e){}
      })();

      const els = {
        lang: document.getElementById("langSel"),
        subject: document.getElementById("subjectSel"),
        topic: document.getElementById("topicSel"),
        item: document.getElementById("itemSel"),
        itemCtl: document.getElementById("itemCtl"),
        list: document.getElementById("itemList"),
        detail: document.getElementById("detailBody"),
        copyBookBtn: document.getElementById("copyBookBtn"),
        listPanel: document.getElementById("listPanel"),
        layoutRoot: document.getElementById("layoutRoot")
      };

      const labels = {
        pageTitle: document.getElementById("pageTitle"),
        pageLede: document.getElementById("pageLede"),
        lblLang: document.getElementById("lblLang"),
        lblSubject: document.getElementById("lblSubject"),
        lblTopic: document.getElementById("lblTopic"),
        lblItem: document.getElementById("lblItem"),
        listTitle: document.getElementById("listTitle"),
        listHint: document.getElementById("listHint"),
        detailHead: document.getElementById("detailHead"),
        detailHint: document.getElementById("detailHint")
      };

      let CONTENT = null;
      let currentLang = "en";
      let currentSubject = "";
      let currentTopic = "";
      let currentItemId = "";

      function setUiLang(lang){
        currentLang = lang;
        document.documentElement.lang = lang;
        const t = UI[lang];
        labels.pageTitle.textContent = t.pageTitle;
        labels.pageLede.textContent = t.pageLede;
        labels.lblLang.textContent = t.lang;
        labels.lblSubject.textContent = t.subject;
        labels.lblTopic.textContent = t.topic;
        labels.lblItem.textContent = t.item;
        labels.listTitle.textContent = t.listTitle;
        labels.listHint.textContent = t.listHint;
        labels.detailHead.textContent = t.detailTitle;
        labels.detailHint.textContent = t.detailHint;
        els.copyBookBtn.textContent = t.copyBooking;
      }

      function escapeHtml(s){
        return String(s || "")
          .replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")
          .replace(/"/g,"&quot;").replace(/'/g,"&#39;");
      }

      function subjectsFor(lang){
        const out = Object.keys((CONTENT && CONTENT.languages && CONTENT.languages[lang]) || {}).sort();
        if(out.indexOf("Social") === -1) out.push("Social");
        return out;
      }

      function topicsFor(lang, subject){
        if(subject === "Social") return ["Social"];
        const subj = (CONTENT.languages[lang] && CONTENT.languages[lang][subject]) ? CONTENT.languages[lang][subject] : {};
        return Object.keys(subj).sort();
      }

      function itemsFor(lang, subject, topic){
        if(subject === "Social") return [];
        const subj = (CONTENT.languages[lang] && CONTENT.languages[lang][subject]) ? CONTENT.languages[lang][subject] : {};
        return (subj[topic] || []);
      }

      function renderSelectOptions(sel, options, isObj){
        sel.innerHTML = "";
        options.forEach(function(o){
          const opt = document.createElement("option");
          if(isObj){
            opt.value = o.id;
            opt.textContent = o.title;
          }else{
            opt.value = o;
            opt.textContent = o;
          }
          sel.appendChild(opt);
        });
      }

      function renderList(items){
        els.list.innerHTML = "";
        if(!items.length){
          const p = document.createElement("p");
          p.className = "note";
          p.textContent = UI[currentLang].noData;
          els.list.appendChild(p);
          return;
        }
        items.forEach(function(it){
          const b = document.createElement("button");
          b.type = "button";
          b.textContent = it.title;
          b.setAttribute("data-id", it.id);
          if(it.id === currentItemId) b.setAttribute("aria-current","true");
          b.addEventListener("click", function(){
            currentItemId = it.id;
            renderAll();
            document.getElementById("detailPanel").scrollIntoView({ behavior: "smooth", block: "start" });
          });
          els.list.appendChild(b);
        });
      }

      function blockHtml(label, value){
        const safe = String(value || "").trim();
        if(!safe) return "";
        const btnLabel = UI[currentLang].copy;
        return (
          '<div class="block">' +
            '<div class="blockTop">' +
              '<strong>' + escapeHtml(label) + '</strong>' +
              '<button class="btn secondary" type="button" data-copy="' + encodeURIComponent(safe) + '">' + escapeHtml(btnLabel) + '</button>' +
            '</div>' +
            '<div class="blockBody">' + escapeHtml(safe) + '</div>' +
          '</div>'
        );
      }

      function imageHtml(imgAbs){
        if(!imgAbs) return "";
        const t = UI[currentLang];
        return (
          '<div class="imgWrap" aria-label="Image">' +
            '<img src="' + imgAbs + '" alt="">' +
            '<div class="imgBar">' +
              '<button class="btn secondary" type="button" data-copy="' + encodeURIComponent(imgAbs) + '">' + escapeHtml(t.copyLink) + '</button>' +
              '<a class="btn secondary" href="' + imgAbs + '" target="_blank" rel="noopener">' + escapeHtml(t.open) + '</a>' +
            '</div>' +
          '</div>'
        );
      }

      function socialHtml(){
        const items = (CONTENT.globals && CONTENT.globals.social) ? CONTENT.globals.social : [];
        const t = UI[currentLang];
        const cards = items.map(function(s){
          const label = (currentLang === "es") ? s.label_es : s.label_en;
          return (
            '<div class="socialCard">' +
              '<div class="socialLeft">' +
                '<img src="' + s.icon + '" alt="">' +
                '<span>' + escapeHtml(label) + '</span>' +
              '</div>' +
              '<button class="btn secondary" type="button" data-copy="' + encodeURIComponent(s.url) + '">' + escapeHtml(t.copy) + '</button>' +
            '</div>'
          );
        }).join("");

        return (
          '<h3 class="detailTitle">' + escapeHtml(t.socials) + '</h3>' +
          '<div class="blocks" style="margin-top:12px;">' +
            '<div class="socialGrid">' + cards + '</div>' +
          '</div>'
        );
      }

      function bindCopy(root){
        (root || document).querySelectorAll("[data-copy]").forEach(function(btn){
          btn.addEventListener("click", async function(){
            const val = decodeURIComponent(btn.getAttribute("data-copy") || "");
            await copyText(val);
          });
        });
      }

      function renderDetail(item){
        const t = UI[currentLang];
        if(!item){
          els.detail.innerHTML = "<p class='note'>" + escapeHtml(t.noData) + "</p>";
          return;
        }

        const blocks = [
          blockHtml(t.short, item.short),
          blockHtml(t.long, item.long),
          blockHtml(t.cost, item.cost)
        ].filter(Boolean).join("");

        let chips = "";
        if(item.cost){
          chips = '<span class="chip">' + escapeHtml(item.cost) + '</span>';
        }

        els.detail.innerHTML =
          '<h3 class="detailTitle">' + escapeHtml(item.title) + '</h3>' +
          '<div class="detailMeta">' + chips + '</div>' +
          '<div class="blocks">' + (blocks || "") + '</div>' +
          imageHtml(item.image);

        bindCopy(els.detail);
      }

      function renderAll(){
        if(!CONTENT) return;

        const subs = subjectsFor(currentLang);
        if(!currentSubject || subs.indexOf(currentSubject) === -1) currentSubject = subs[0] || "Social";
        renderSelectOptions(els.subject, subs, false);

        const topics = topicsFor(currentLang, currentSubject);
        if(!currentTopic || topics.indexOf(currentTopic) === -1) currentTopic = topics[0] || "";
        renderSelectOptions(els.topic, topics, false);

        const book = (CONTENT.globals && CONTENT.globals.booking_links) ? CONTENT.globals.booking_links[currentLang] : "";
        els.copyBookBtn.setAttribute("data-copy", encodeURIComponent(book || ""));

        if(currentSubject === "Social"){
          els.itemCtl.style.display = "none";
          els.listPanel.style.display = "none";
          els.layoutRoot.style.gridTemplateColumns = "1fr";
          els.detail.innerHTML = socialHtml();
          bindCopy(els.detail);
          return;
        }

        els.itemCtl.style.display = "";
        els.listPanel.style.display = "";
        els.layoutRoot.style.gridTemplateColumns = "";

        const items = itemsFor(currentLang, currentSubject, currentTopic);

        renderSelectOptions(els.item, items, true);

        if(!currentItemId || !items.some(function(x){ return x.id === currentItemId; })){
          currentItemId = items[0] ? items[0].id : "";
        }
        if(els.item.value !== currentItemId) els.item.value = currentItemId;

        renderList(items);

        const selected = items.find(function(x){ return x.id === currentItemId; }) || null;
        renderDetail(selected);
      }

      async function loadContent(){
        const res = await fetch("./staff-content.json", { cache: "no-store" });
        return await res.json();
      }

      function bindEvents(){
        els.lang.addEventListener("change", function(){
          setUiLang(els.lang.value);
          currentSubject = "";
          currentTopic = "";
          currentItemId = "";
          renderAll();
          localStorage.setItem("mbw_staff_lang", els.lang.value);
        });

        els.subject.addEventListener("change", function(){
          currentSubject = els.subject.value;
          currentTopic = "";
          currentItemId = "";
          renderAll();
        });

        els.topic.addEventListener("change", function(){
          currentTopic = els.topic.value;
          currentItemId = "";
          renderAll();
        });

        els.item.addEventListener("change", function(){
          currentItemId = els.item.value;
          renderAll();
          document.getElementById("detailPanel").scrollIntoView({ behavior: "smooth", block: "start" });
        });

        els.copyBookBtn.addEventListener("click", async function(){
          const val = decodeURIComponent(els.copyBookBtn.getAttribute("data-copy") || "");
          await copyText(val);
        });
      }

      (async function init(){
        try{
          CONTENT = await loadContent();
        }catch(e){
          console.error(e);
          return;
        }

        const saved = localStorage.getItem("mbw_staff_lang");
        if(saved === "es") els.lang.value = "es";

        setUiLang(els.lang.value);
        bindEvents();
        renderAll();
      })();
    })();
  </script>
  <script src="/assets/js/site.js?v=1" defer></script>
</body>
</html>
