<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Staff Info | Mindo Bird Watching</title>
  <meta name="robots" content="noindex,nofollow" />
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#034EA2">
  <link rel="stylesheet" href="/assets/css/site.css">
  <link rel="stylesheet" href="/assets/css/header.css?v=1">
  <script src="/assets/js/head.js" defer></script>
  <style>
    /* Page shell */
    *, *:before, *:after { box-sizing: border-box; }
    html, body { height: 100%; }
    body { overflow-x: hidden; }
    .page { margin-top: 18px; padding: 18px; }
    .page.card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--r);
      box-shadow: var(--shadow);
    }

    /* Top */
    .hero{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      margin-bottom: 12px;
    }
    h1{ margin:0; letter-spacing:-0.02em; }
    .lede{ margin:0; max-width: 92ch; color: var(--ink); line-height: 1.6; }
    .metaPills{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.55);
      font-weight: 900;
      color: var(--ink);
      font-size: 12.5px;
      line-height: 1;
      white-space: nowrap;
    }

    /* App layout */
    .app{
      display:grid;
      grid-template-columns: minmax(0, 1fr) minmax(0, 1.1fr);
      gap: 14px;
      align-items:start;
    }
    .cardBox{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardPad{ padding: 14px; }

    /* Filters */
    .filters{
      display:grid;
      gap: 10px;
    }
    .langRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .seg{
      display:inline-flex;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.55);
      border-radius: 999px;
      overflow:hidden;
      box-shadow: var(--shadow);
    }
    .seg button{
      appearance:none;
      border:0;
      background:transparent;
      padding: 8px 12px;
      font-weight: 950;
      color: var(--ink);
      font-size: 12.5px;
      cursor:pointer;
      line-height: 1;
    }
    .seg button[aria-pressed="true"]{
      background: rgba(3,78,162,.14);
      color: #034EA2;
    }
    .count{
      font-weight: 900;
      color: var(--muted);
      font-size: 12.5px;
    }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .field{
      display:grid;
      gap:6px;
    }
    label{
      font-size: 12px;
      color: var(--muted);
      font-weight: 900;
      letter-spacing: .01em;
      text-transform: none;
    }
    select, input{
      width: 100%;
      max-width: 100%;
      padding: 12px 12px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.55);
      box-shadow: var(--shadow);
      font: inherit;
      color: var(--ink);
      outline: none;
      min-width: 0;
    }
    input::placeholder{ color: rgba(0,0,0,.45); }

    .hint{
      margin:0;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.5;
    }

    /* List */
    .list{
      display:grid;
      gap:10px;
      margin-top: 12px;
    }
    .itemBtn{
      width:100%;
      text-align:left;
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.55);
      box-shadow: var(--shadow);
      padding: 12px;
      cursor:pointer;
      display:grid;
      gap:4px;
    }
    .itemBtn:hover{ border-color: rgba(3,78,162,.35); }
    .itemBtn[aria-current="true"]{
      border-color: rgba(3,78,162,.55);
      box-shadow: 0 0 0 3px rgba(3,78,162,.12), var(--shadow);
    }
    .itemTitle{
      margin:0;
      font-weight: 950;
      color: var(--ink);
      letter-spacing: -0.01em;
      line-height: 1.25;
      font-size: 14px;
    }
    .itemMeta{
      margin:0;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.35;
    }
    .itemTags{
      display:flex;
      gap:6px;
      flex-wrap:wrap;
      margin-top: 4px;
    }
    .tag{
      display:inline-flex;
      align-items:center;
      padding: 6px 9px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.55);
      font-size: 12px;
      font-weight: 900;
      color: var(--ink);
      line-height: 1;
      white-space: nowrap;
    }

    /* Detail */
    .detailHead{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      margin-bottom: 10px;
    }
    .detailTitle{
      margin:0;
      font-family: var(--font-head);
      color: var(--forest);
      letter-spacing:-0.02em;
      font-size: 22px;
      line-height: 1.15;
      font-weight: 950;
    }
    .detailSub{
      margin:0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.4;
      font-weight: 900;
    }

    .replyBox{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.55);
      box-shadow: var(--shadow);
      padding: 12px;
      display:grid;
      gap:10px;
      margin-top: 10px;
      min-width: 0;
    }
    .replyTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .replyTop h3{
      margin:0;
      font-weight: 950;
      font-size: 14px;
      color: var(--ink);
      letter-spacing: -0.01em;
    }
    .btnSmall{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.65);
      font-weight: 950;
      color: var(--ink);
      font-size: 12.5px;
      cursor:pointer;
      line-height: 1;
      white-space: nowrap;
    }
    .btnSmall.primary{
      background: rgba(3,78,162,.14);
      color: #034EA2;
      border-color: rgba(3,78,162,.35);
    }
    .replyText{
      margin:0;
      color: var(--ink);
      line-height: 1.65;
      font-size: 14px;
      white-space: pre-wrap;
      overflow-wrap:anywhere;
    }

    .mediaGrid{
      display:grid;
      grid-template-columns: minmax(0, 1fr);
      gap:10px;
      margin-top: 10px;
    }
    .imgCard{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.55);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .imgFrame{
      width:100%;
      aspect-ratio: 16 / 9;
      background: rgba(255,255,255,.5);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .imgFrame img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      cursor:pointer;
    }
    .imgActions{
      border-top: 1px solid var(--line);
      padding: 10px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-end;
      background: rgba(255,255,255,.55);
    }

    /* Social */
    .socialList{ margin-top: 12px; }
    .socialItem{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px;
      border-radius: var(--r);
      border: 1px solid var(--line);
      background: rgba(255,255,255,.55);
      box-shadow: var(--shadow);
      margin-top: 10px;
      min-width: 0;
    }
    .socialIcon{
      width:26px;
      height:26px;
      flex: 0 0 auto;
      display:block;
      object-fit:contain;
    }
    .socialText{
      min-width: 0;
      flex: 1 1 auto;
    }
    .socialName{
      margin:0;
      font-weight: 950;
      color: var(--ink);
      font-size: 13px;
      line-height: 1.2;
    }
    .socialUrl{
      margin:0;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.35;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }

    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(20,20,20,.92);
      color: #fff;
      padding: 10px 12px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 12.5px;
      letter-spacing: .01em;
      box-shadow: 0 12px 28px rgba(0,0,0,.25);
      opacity: 0;
      pointer-events: none;
      transition: opacity .15s ease;
      z-index: 9999;
      max-width: calc(100vw - 24px);
      text-align:center;
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .toast.show{ opacity: 1; }

    @media (max-width: 980px){
      .app{ grid-template-columns: 1fr; }
    }
    @media (max-width: 640px){
      .page{ padding: 14px; margin-top: 14px; }
      .grid2{ grid-template-columns: 1fr; }
      .detailTitle{ font-size: 20px; }
      .imgFrame{ aspect-ratio: 4 / 3; }
      .toast{ bottom: 12px; }
    }
  
    /* Media URL row (copy image URL) */
    .urlRow{
      margin-top: 10px;
      display: grid;
      grid-template-columns: 86px 1fr auto;
      gap: 8px;
      align-items: center;
      padding: 10px;
      border-top: 1px solid var(--line);
      background: rgba(255,255,255,.55);
      border-radius: 14px;
    }
    .urlLabel{
      font-weight: 900;
      color: var(--muted);
      font-size: 12.5px;
      white-space: nowrap;
    }
    .urlInput{
      width: 100%;
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px 10px;
      font: inherit;
      color: var(--ink);
      background: rgba(255,255,255,.85);
      min-width: 0;
    }
    @media (max-width: 520px){
      .urlRow{ grid-template-columns: 1fr; }
      .urlLabel{ display:none; }
      .copyBtn{ width: 100%; }
    }

  </style>
</head>
<body>
  <div class="container">
    <div id="siteHeader"></div>

    <main class="page card">
      <div class="hero">
        <div>
          <h1>Staff Info</h1>
          <p class="lede">Use filters to find the right answer fast. Copy short or detailed replies for chat or email. If a guest asks for prices, confirm date and group size. For tours: <strong>tours@mindobirdwatching.com</strong></p>
        </div>
        <div class="metaPills" aria-label="Page badges">
          <span class="pill">Protected via Cloudflare Access</span>
          <span class="pill">Copy buttons for mobile</span>
        </div>
      </div>

      <section class="app" aria-label="Staff info app">
        <!-- LEFT -->
        <div class="cardBox">
          <div class="cardPad">
            <div class="filters">
              <div class="langRow">
                <div class="seg" role="group" aria-label="Language">
                  <button id="btnEN" type="button" aria-pressed="true">English</button>
                  <button id="btnES" type="button" aria-pressed="false">Espanol</button>
                </div>
                <div class="count"><span id="resultCount">0</span> items</div>
              </div>

              <div class="grid2">
                <div class="field">
                  <label for="subjectSel">Subject</label>
                  <select id="subjectSel"></select>
                </div>
                <div class="field">
                  <label for="topicSel">Topic</label>
                  <select id="topicSel"></select>
                </div>
              </div>

              <div class="field">
                <label for="searchBox">Search</label>
                <input id="searchBox" type="search" placeholder="Search titles..." autocomplete="off" />
              </div>

              <p class="hint">Tip: select an item to open copy buttons and any images on the right.</p>
            </div>

            <div id="list" class="list" aria-label="Results list"></div>
          </div>
        </div>

        <!-- RIGHT -->
        <div class="cardBox">
          <div class="cardPad" id="detail" aria-label="Detail panel">
            <p class="hint" style="margin:0;">Select an item on the left to see replies and media.</p>
          </div>
        </div>
      </section>
    </main>

    <div id="siteFooter"></div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>

    (function(){
      async function inject(id, url){
        var el = document.getElementById(id);
        if(!el) return;
        var res = await fetch(url, { cache: "no-store" });
        el.innerHTML = await res.text();
      }
      function loadScript(src){
        return new Promise(function(resolve, reject){
          var s = document.createElement("script");
          s.src = src;
          s.defer = true;
          s.onload = resolve;
          s.onerror = reject;
          document.body.appendChild(s);
        });
      }

      var ICONS = {
        "Instagram": "/assets/images/icons/MBW-IG.png",
        "TikTok": "/assets/images/icons/MBW-Social-TikTok.png",
        "Facebook": "/assets/images/icons/MBW-Social-FB-01.png",
        "YouTube": "/assets/images/icons/MBW-Social-YouTube.png",
        "Google Review Link": "/assets/images/icons/Google-Review-Symbol.png",
        "Shop": "/assets/images/icons/MBW-Social-Shopify.png",
        "Shopify": "/assets/images/icons/MBW-Social-Shopify.png"
      };

      var state = {
        lang: "en",
        data: null,
        subject: "",
        topic: "",
        search: "",
        selectedId: ""
      };

      function toast(msg){
        var t = document.getElementById("toast");
        if(!t) return;
        t.textContent = msg;
        t.classList.add("show");
        window.clearTimeout(toast._timer);
        toast._timer = window.setTimeout(function(){ t.classList.remove("show"); }, 1300);
      }

      function norm(s){ return String(s || "").toLowerCase().trim(); }

      function getLangRoot(){
        if(!state.data) return {};
        if(state.data.languages && state.data.languages[state.lang]) return state.data.languages[state.lang];
        if(state.data[state.lang]) return state.data[state.lang];
        return {};
      }

      function subjects(){
        var root = getLangRoot();
        return Object.keys(root).filter(Boolean).sort(function(a,b){ return a.localeCompare(b); });
      }

      function topicsForSubject(subject){
        var root = getLangRoot();
        var subj = root[subject] || {};
        return Object.keys(subj).filter(Boolean).sort(function(a,b){ return a.localeCompare(b); });
      }

      function flattenItems(subject, topic){
        var root = getLangRoot();
        var subj = root[subject] || {};
        var items = (subj[topic] || []).slice();
        return items;
      }

      function allItemsForSubject(subject){
        var root = getLangRoot();
        var subj = root[subject] || {};
        var out = [];
        Object.keys(subj).forEach(function(tp){
          (subj[tp] || []).forEach(function(it){
            out.push(Object.assign({ _topic: tp }, it));
          });
        });
        return out;
      }

      function currentList(){
        if(!state.subject) return [];
        var items = state.topic === "All" ? allItemsForSubject(state.subject) : flattenItems(state.subject, state.topic).map(function(it){ return Object.assign({ _topic: state.topic }, it); });
        var q = norm(state.search);
        if(q){
          items = items.filter(function(it){
            return norm(it.title).indexOf(q) !== -1 || norm(it.subtopic).indexOf(q) !== -1 || norm(it.message_short).indexOf(q) !== -1 || norm(it.message_long).indexOf(q) !== -1;
          });
        }
        return items;
      }

      function setSelectOptions(sel, options, selected){
        sel.innerHTML = "";
        options.forEach(function(opt){
          var o = document.createElement("option");
          o.value = opt;
          o.textContent = opt;
          if(opt === selected) o.selected = true;
          sel.appendChild(o);
        });
      }

      function refreshSelectors(){
        var subjSel = document.getElementById("subjectSel");
        var topicSel = document.getElementById("topicSel");

        var subs = subjects();
        if(!subs.length){
          setSelectOptions(subjSel, ["No subjects"], "No subjects");
          setSelectOptions(topicSel, ["All"], "All");
          return;
        }

        if(!state.subject || subs.indexOf(state.subject) === -1){
          state.subject = subs[0];
        }
        setSelectOptions(subjSel, subs, state.subject);

        var tps = topicsForSubject(state.subject);
        tps.unshift("All");
        if(!state.topic || tps.indexOf(state.topic) === -1){
          state.topic = "All";
        }
        setSelectOptions(topicSel, tps, state.topic);
      }

      function renderList(){
        var listEl = document.getElementById("list");
        var items = currentList();
        document.getElementById("resultCount").textContent = String(items.length);

        listEl.innerHTML = "";
        if(!items.length){
          var p = document.createElement("p");
          p.className = "hint";
          p.style.margin = "10px 0 0";
          p.textContent = "No results for the current filters.";
          listEl.appendChild(p);
          document.getElementById("detail").innerHTML = '<p class="hint" style="margin:0;">Select an item on the left to see replies and media.</p>';
          return;
        }

        if(!state.selectedId || !items.some(function(it){ return String(it.id) === String(state.selectedId); })){
          state.selectedId = String(items[0].id);
        }

        items.forEach(function(it){
          var btn = document.createElement("button");
          btn.type = "button";
          btn.className = "itemBtn";
          btn.setAttribute("aria-current", String(it.id) === String(state.selectedId) ? "true" : "false");
          btn.addEventListener("click", function(){
            state.selectedId = String(it.id);
            renderList();
            renderDetail();
          });

          var title = document.createElement("p");
          title.className = "itemTitle";
          title.textContent = it.title || "(Untitled)";

          var meta = document.createElement("p");
          meta.className = "itemMeta";
          meta.textContent = it.subtopic ? it.subtopic : (it._topic ? it._topic : "");

          btn.appendChild(title);
          if(meta.textContent) btn.appendChild(meta);

          var tags = document.createElement("div");
          tags.className = "itemTags";

          if(it._topic){
            var tag = document.createElement("span");
            tag.className = "tag";
            tag.textContent = it._topic;
            tags.appendChild(tag);
          }
          if(it.last_updated){
            var t2 = document.createElement("span");
            t2.className = "tag";
            t2.textContent = it.last_updated;
            tags.appendChild(t2);
          }
          if(tags.children.length) btn.appendChild(tags);

          listEl.appendChild(btn);
        });
      }

      async function copyText(text){
        try{
          await navigator.clipboard.writeText(text);
          toast("Copied");
        }catch(e){
          toast("Copy failed");
        }
      }

      async function copyImageFromUrl(url){
        try{
          if(!navigator.clipboard || !window.ClipboardItem){
            await copyText(url);
            return;
          }
          var res = await fetch(url, { cache: "no-store" });
          var blob = await res.blob();
          var item = new ClipboardItem({ [blob.type]: blob });
          await navigator.clipboard.write([item]);
          toast("Image copied");
        }catch(e){
          await copyText(url);
          toast("Copied image link");
        }
      }

      function absUrl(path){
        if(!path) return "";
        if(/^https?:\/\//i.test(path)) return path;
        if(path.startsWith("/")) return window.location.origin + path;
        return window.location.origin + "/" + path.replace(/^\.\//, "");
      }

      function renderReplyBox(title, text, btnLabel, btnPrimary){
        var box = document.createElement("div");
        box.className = "replyBox";

        var top = document.createElement("div");
        top.className = "replyTop";

        var h = document.createElement("h3");
        h.textContent = title;

        var b = document.createElement("button");
        b.type = "button";
        b.className = "btnSmall" + (btnPrimary ? " primary" : "");
        b.textContent = btnLabel;
        b.addEventListener("click", function(){ copyText(text); });

        top.appendChild(h);
        top.appendChild(b);

        var p = document.createElement("p");
        p.className = "replyText";
        p.textContent = text;

        box.appendChild(top);
        box.appendChild(p);
        return box;
      }

      function renderSocial(lang){
        var wrap = document.createElement("div");
        wrap.className = "replyBox";
        wrap.style.marginTop = "12px";

        var top = document.createElement("div");
        top.className = "replyTop";

        var h = document.createElement("h3");
        h.textContent = "Social links";

        var b = document.createElement("button");
        b.type = "button";
        b.className = "btnSmall";
        b.textContent = "Copy all";
        b.addEventListener("click", function(){
          var all = getSocialLinks(lang).map(function(s){ return s.platform + ": " + s.url; }).join("
");
          copyText(all);
        });

        top.appendChild(h);
        top.appendChild(b);
        wrap.appendChild(top);

        var list = document.createElement("div");
        list.className = "socialList";

        getSocialLinks(lang).forEach(function(s){
          var row = document.createElement("div");
          row.className = "socialItem";

          var img = document.createElement("img");
          img.className = "socialIcon";
          img.alt = s.platform + " icon";
          img.src = ICONS[s.platform] || "/assets/images/icons/MBW-IG.png";

          var tx = document.createElement("div");
          tx.className = "socialText";

          var n = document.createElement("p");
          n.className = "socialName";
          n.textContent = s.platform;

          var u = document.createElement("p");
          u.className = "socialUrl";
          u.textContent = s.url;

          tx.appendChild(n);
          tx.appendChild(u);

          var c = document.createElement("button");
          c.type = "button";
          c.className = "btnSmall";
          c.textContent = "Copy";
          c.addEventListener("click", function(){ copyText(s.url); });

          row.appendChild(img);
          row.appendChild(tx);
          row.appendChild(c);
          list.appendChild(row);
        });

        wrap.appendChild(list);
        return wrap;
      }

      function getSocialLinks(lang){
        if(!state.data) return [];
        if(state.data.social_links && state.data.social_links[lang]) return state.data.social_links[lang];
        return [];
      }

      function renderDetail(){
        var detail = document.getElementById("detail");
        var items = currentList();
        var item = items.find(function(it){ return String(it.id) === String(state.selectedId); }) || items[0];
        if(!item){
          detail.innerHTML = '<p class="hint" style="margin:0;">Select an item on the left to see replies and media.</p>';
          return;
        }

        detail.innerHTML = "";

        var head = document.createElement("div");
        head.className = "detailHead";

        var left = document.createElement("div");
        var t = document.createElement("p");
        t.className = "detailTitle";
        t.textContent = item.title || "Details";

        var s = document.createElement("p");
        s.className = "detailSub";
        var sub = [];
        if(state.subject) sub.push(state.subject);
        if(item._topic) sub.push(item._topic);
        if(item.subtopic) sub.push(item.subtopic);
        s.textContent = sub.join(" | ");

        left.appendChild(t);
        left.appendChild(s);

        var right = document.createElement("div");
        right.style.display = "flex";
        right.style.gap = "10px";
        right.style.flexWrap = "wrap";
        right.style.alignItems = "center";

        var copyBoth = document.createElement("button");
        copyBoth.type = "button";
        copyBoth.className = "btnSmall primary";
        copyBoth.textContent = "Copy short + detailed";
        copyBoth.addEventListener("click", function(){
          var parts = [];
          if(item.message_short) parts.push(item.message_short.trim());
          if(item.message_long) parts.push(item.message_long.trim());
          copyText(parts.join("

").trim());
        });

        right.appendChild(copyBoth);

        head.appendChild(left);
        head.appendChild(right);
        detail.appendChild(head);

        if(item.message_short){
          detail.appendChild(renderReplyBox("Short reply", item.message_short, "Copy short", true));
        }
        if(item.message_long){
          detail.appendChild(renderReplyBox("Detailed reply", item.message_long, "Copy detailed", false));
        }
        if(!item.message_short && !item.message_long){
          var p = document.createElement("p");
          p.className = "hint";
          p.style.margin = "0";
          p.textContent = "No message text found for this item.";
          detail.appendChild(p);
        }

        /* Images */
        
        var imgUrl = item.image_url || "";
        if(imgUrl){
          var absUrl = (function(u){
            try{ return new URL(u, window.location.origin).toString(); }catch(_){ return u; }
          })(imgUrl);

          var mediaBox = document.createElement("div");
          mediaBox.className = "mediaBox";

          var frame = document.createElement("div");
          frame.className = "imgFrame";
          var img = document.createElement("img");
          img.src = absUrl;
          img.alt = (item.title || "Image");
          img.loading = "lazy";
          frame.appendChild(img);
          mediaBox.appendChild(frame);

          var urlRow = document.createElement("div");
          urlRow.className = "urlRow";
          var urlLabel = document.createElement("div");
          urlLabel.className = "urlLabel";
          urlLabel.textContent = "Image URL";
          var urlInput = document.createElement("input");
          urlInput.className = "urlInput";
          urlInput.type = "text";
          urlInput.readOnly = true;
          urlInput.value = absUrl;

          var urlBtn = document.createElement("button");
          urlBtn.className = "copyBtn";
          urlBtn.type = "button";
          urlBtn.textContent = "Copy URL";
          urlBtn.addEventListener("click", function(){
            copyText(absUrl, urlBtn);
          });

          urlRow.appendChild(urlLabel);
          urlRow.appendChild(urlInput);
          urlRow.appendChild(urlBtn);
          mediaBox.appendChild(urlRow);

          detail.appendChild(mediaBox);
        }
        }

        /* Social links always */
        if(getSocialLinks(state.lang).length){
          detail.appendChild(renderSocial(state.lang));
        }
      }

      function bindEvents(){
        var btnEN = document.getElementById("btnEN");
        var btnES = document.getElementById("btnES");

        btnEN.addEventListener("click", function(){
          state.lang = "en";
          btnEN.setAttribute("aria-pressed","true");
          btnES.setAttribute("aria-pressed","false");
          state.selectedId = "";
          refreshSelectors();
          renderList();
          renderDetail();
        });
        btnES.addEventListener("click", function(){
          state.lang = "es";
          btnEN.setAttribute("aria-pressed","false");
          btnES.setAttribute("aria-pressed","true");
          state.selectedId = "";
          refreshSelectors();
          renderList();
          renderDetail();
        });

        document.getElementById("subjectSel").addEventListener("change", function(e){
          state.subject = e.target.value;
          state.topic = "All";
          state.selectedId = "";
          refreshSelectors();
          renderList();
          renderDetail();
        });
        document.getElementById("topicSel").addEventListener("change", function(e){
          state.topic = e.target.value;
          state.selectedId = "";
          renderList();
          renderDetail();
        });

        var sb = document.getElementById("searchBox");
        sb.addEventListener("input", function(e){
          state.search = e.target.value;
          state.selectedId = "";
          renderList();
          renderDetail();
        });
      }

      async function loadData(){
        var res = await fetch("./staff-content.json?ts=" + Date.now(), { cache: "no-store" });
        if(!res.ok) throw new Error("Failed to load staff-content.json");
        state.data = await res.json();
      }

      (async function(){
        await inject("siteHeader", "/assets/includes/header.html");
        await inject("siteFooter", "/assets/includes/footer.html");
        await loadScript("/assets/js/site.js");

        await loadData();
        bindEvents();
        refreshSelectors();
        renderList();
        renderDetail();
      })();
    })();
  
  </script>
</body>
</html>
