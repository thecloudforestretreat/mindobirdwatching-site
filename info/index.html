<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Staff Info | Mindo Bird Watching</title>
  <meta name="description" content="Private staff reference page for quick tour, activity, FAQ, and transportation replies. Search, copy, and send accurate info fast." />
  <link rel="canonical" href="https://staging.mindobirdwatching.com/info/" />
  <link rel="alternate" hreflang="en" href="/info/" />
  <link rel="alternate" hreflang="es" href="/info/" />

  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Mindo Bird Watching" />
  <meta property="og:title" content="Staff Info | Mindo Bird Watching" />
  <meta property="og:description" content="Private staff reference page for quick tour, activity, FAQ, and transportation replies. Search, copy, and send accurate info fast." />
  <meta property="og:url" content="https://staging.mindobirdwatching.com/info/" />
  <meta property="og:image" content="https://staging.mindobirdwatching.com/MBW-Assets-OG-Image.png" />
  <meta property="og:image:secure_url" content="https://staging.mindobirdwatching.com/MBW-Assets-OG-Image.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="Mindo Bird Watching - guided birding tours in Ecuador's cloud forest" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Staff Info | Mindo Bird Watching" />
  <meta name="twitter:description" content="Private staff reference page for quick tour, activity, FAQ, and transportation replies. Search, copy, and send accurate info fast." />
  <meta name="twitter:image" content="https://staging.mindobirdwatching.com/MBW-Assets-OG-Image.png" />

  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#034EA2">

  <link rel="stylesheet" href="/assets/css/site.css">
  <link rel="stylesheet" href="/assets/css/header.css?v=1">
  <script src="/assets/js/head.js" defer></script>

  <style>
    *{ box-sizing: border-box; }
    img{ max-width: 100%; height: auto; }

    .page{ margin-top:18px; padding:26px; }
    .page.card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .hero{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:16px;
      align-items:start;
    }
    h1{ margin:0 0 8px; letter-spacing:-0.02em; }
    .lede{ margin:0; max-width: 92ch; color: var(--ink); line-height: 1.65; }

    .metaCard{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      padding: 14px;
      display:grid;
      gap:12px;
    }

    .row{ display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:space-between; }
    .chips{ display:flex; flex-wrap:wrap; gap:8px; align-items:center; }

    .chip{
      display:inline-flex;
      align-items:center;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.55);
      font-weight: 900;
      color: var(--ink);
      font-size: 12.5px;
      line-height: 1;
      white-space: nowrap;
    }

    .note{ margin:0; color: var(--muted); font-size: 13px; line-height: 1.55; }

    .seg{
      display:inline-flex;
      border: 1px solid var(--line);
      border-radius: 999px;
      background: rgba(255,255,255,.55);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .seg button{
      appearance:none;
      border:0;
      background:transparent;
      padding: 10px 14px;
      font-weight: 950;
      font-size: 12.5px;
      color: var(--ink);
      cursor:pointer;
      line-height: 1;
      min-height: 40px;
    }
    .seg button[aria-pressed="true"]{
      background: rgba(3,78,162,.10);
      color: var(--forest);
    }

    .filters{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }

    .filterPill{
      border: 1px solid var(--line);
      border-radius: 999px;
      background: rgba(255,255,255,.55);
      box-shadow: var(--shadow);
      padding: 8px 12px;
      display:flex;
      align-items:center;
      gap: 10px;
      min-height: 44px;
      min-width: 0;
    }

    .filterPill label{
      font-weight: 900;
      font-size: 12.5px;
      color: var(--muted);
      white-space: nowrap;
      flex: 0 0 auto;
    }

    .filterPill select,
    .filterPill input{
      border: 0;
      outline: 0;
      background: transparent;
      color: var(--ink);
      font-weight: 900;
      width: 100%;
      padding: 0;
      height: 28px;
      line-height: 28px;
      min-width: 0;
    }

    .actionsCard{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      padding: 14px;
      display:grid;
      gap:10px;
    }

    .actionTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }

    .btnRow{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .btnRow .btn{ flex: 0 0 auto; }

    .section{
      margin-top:18px;
      padding-top:14px;
      border-top: 1px solid var(--line);
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr .95fr;
      gap: 14px;
      align-items:start;
    }

    .list{
      display:grid;
      gap: 10px;
      min-width: 0;
    }

    .itemBtn{
      width:100%;
      text-align:left;
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      padding: 12px 12px;
      cursor:pointer;
      display:grid;
      gap:6px;
      min-width: 0;
    }

    .itemBtn[aria-current="true"]{
      outline: 2px solid rgba(3,78,162,.25);
      outline-offset: 0;
    }

    .itemTitle{
      margin:0;
      font-weight: 950;
      letter-spacing:-0.01em;
      color: var(--ink);
      font-size: 14px;
      line-height: 1.35;
      word-break: break-word;
    }

    .itemMeta{
      margin:0;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.45;
    }

    .detail{
      border: 1px solid var(--line);
      border-radius: var(--r);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      padding: 14px;
      display:grid;
      gap: 12px;
      position: sticky;
      top: 92px;
      min-width: 0;
    }

    .detail h2{
      margin:0;
      font-family: var(--font-head);
      color: var(--forest);
      letter-spacing:-0.02em;
      font-size: 18px;
      line-height: 1.25;
      font-weight: 950;
      word-break: break-word;
    }

    .block{
      border: 1px solid var(--line);
      border-radius: 18px;
      background: rgba(255,255,255,.55);
      padding: 12px;
      display:grid;
      gap: 8px;
      min-width: 0;
    }

    .blockHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    .blockTitle{
      margin:0;
      font-weight: 950;
      color: var(--ink);
      font-size: 13px;
      letter-spacing:-0.01em;
    }

    .copyBtn{
      appearance:none;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.65);
      box-shadow: var(--shadow);
      border-radius: 999px;
      padding: 8px 10px;
      font-weight: 950;
      font-size: 12.5px;
      cursor:pointer;
      line-height: 1;
      white-space: nowrap;
    }

    .copyBtn:focus-visible{
      outline: 2px solid rgba(3,78,162,.35);
      outline-offset: 2px;
    }

    .txt{
      margin:0;
      color: var(--ink);
      line-height: 1.7;
      font-size: 14px;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .empty{
      border: 1px dashed var(--line);
      border-radius: var(--r);
      padding: 12px;
      background: rgba(255,255,255,.45);
      color: var(--muted);
      font-weight: 900;
      font-size: 13px;
    }

    /* Promo image */
    .promoFigure{ margin:0; display:grid; gap:10px; }
    .promoImg{
      width:100%;
      height:auto;
      max-height: 340px;
      object-fit: contain;
      border: 1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.55);
      box-shadow: var(--shadow);
    }
    .promoBtnRow{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }

    /* Social rows (icon + label only) */
    .socialGrid{ display:grid; gap:10px; }
    .socialRow{
      display:grid;
      grid-template-columns: 1fr auto;
      gap:10px;
      align-items:center;
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 10px 10px;
      background: rgba(255,255,255,.55);
      min-width: 0;
    }
    .socialLeft{ display:flex; gap:10px; align-items:center; min-width:0; }
    .socialIcon{ width:28px; height:28px; object-fit:contain; flex:0 0 auto; }
    .socialName{
      font-weight: 950;
      color: var(--ink);
      font-size: 14px;
      line-height: 1.2;
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
      min-width: 0;
    }

    .toast{
      position: fixed;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(17,24,39,.92);
      color: #fff;
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 900;
      box-shadow: 0 8px 24px rgba(0,0,0,.18);
      opacity: 0;
      pointer-events: none;
      transition: opacity .18s ease;
      z-index: 9999;
      max-width: calc(100vw - 32px);
      text-align: center;
    }
    .toast.show{ opacity: 1; }

    @media (max-width: 980px){
      .hero{ grid-template-columns: 1fr; }
      .grid{ grid-template-columns: 1fr; }
      .detail{ position: relative; top: 0; }
    }

    @media (max-width: 640px){
      .page{ padding:16px; margin-top:14px; }
      .filters{ grid-template-columns: 1fr; }
      .detail{ padding:12px; }
      .block{ padding: 10px; }
      .promoImg{ max-height: 260px; }
      .socialIcon{ width:26px; height:26px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="siteHeader"></div>

    <main class="page card" aria-label="Staff info">
      <section class="hero" aria-label="Staff info introduction">
        <div>
          <h1 id="pageTitle">Staff Info</h1>
          <p class="lede" id="pageLede">Use filters to find the right answer fast. Copy and paste short or detailed replies to chat or email.</p>

          <div class="metaCard" aria-label="Controls">
            <div class="row">
              <div class="chips" aria-label="Language">
                <span class="chip" id="langLabel">Language</span>
                <div class="seg" role="group" aria-label="Language toggle">
                  <button id="langEn" type="button" aria-pressed="true">English</button>
                  <button id="langEs" type="button" aria-pressed="false">Espa√±ol</button>
                </div>
              </div>

              <div class="chips" aria-label="Status">
                <span class="chip" id="statusChip">Loading...</span>
                <span class="chip"><span id="count">0</span> items</span>
              </div>
            </div>

            <div class="filters" aria-label="Filters">
              <div class="filterPill">
                <label for="subjectSel" id="subjectLabel">Subject</label>
                <select id="subjectSel"></select>
              </div>

              <div class="filterPill">
                <label for="topicSel" id="topicLabel">Topic</label>
                <select id="topicSel"></select>
              </div>

              <div class="filterPill" style="grid-column: 1 / -1;">
                <label for="q" id="searchLabel">Search</label>
                <input id="q" type="search" placeholder="Search titles..." autocomplete="off" />
              </div>
            </div>

            <p class="note" id="hint">Tip: select a subject, then tap Copy to send a quick reply.</p>
          </div>
        </div>

        <aside class="actionsCard" aria-label="Quick actions">
          <div class="actionTop">
            <span class="chip" id="quickTitle">Quick actions</span>
            <button class="btn secondary" type="button" id="copyBookingLink">Copy booking link</button>
          </div>
          <p class="note" id="reservationsLine">Reservations: <strong>tours@mindobirdwatching.com</strong></p>
          <p class="note" id="quickTip">If a guest asks for prices, confirm the date and group size.</p>
        </aside>
      </section>

      <section class="section" aria-label="Results">
        <div class="grid">
          <div class="list" id="list" aria-label="Items list"></div>

          <aside class="detail" aria-label="Item detail">
            <h2 id="detailTitle">Select an item</h2>
            <div id="blocks"></div>
          </aside>
        </div>
      </section>
    </main>

    <div id="siteFooter"></div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
  (function(){
    const BASE_ORIGIN = window.location.origin;
    const DATA_URL = "./staff-content.json?v=" + Date.now();

    function $(id){ return document.getElementById(id); }

    function esc(s){
      return String(s ?? "")
        .replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")
        .replace(/"/g,"&quot;").replace(/'/g,"&#39;");
    }

    function toast(msg){
      const el = $("toast");
      if(!el) return;
      el.textContent = msg;
      el.classList.add("show");
      clearTimeout(toast._t);
      toast._t = setTimeout(() => el.classList.remove("show"), 1600);
    }

    async function copyText(text){
      const t = String(text ?? "");
      try{
        if(navigator.clipboard && window.isSecureContext){
          await navigator.clipboard.writeText(t);
          return true;
        }
      }catch(e){}
      try{
        const ta = document.createElement("textarea");
        ta.value = t;
        ta.setAttribute("readonly","");
        ta.style.position = "fixed";
        ta.style.top = "-9999px";
        ta.style.left = "-9999px";
        document.body.appendChild(ta);
        ta.select();
        ta.setSelectionRange(0, ta.value.length);
        const ok = document.execCommand("copy");
        document.body.removeChild(ta);
        return ok;
      }catch(e){
        return false;
      }
    }

    async function copyImage(url){
      const abs = absUrl(url);
      try{
        if(!navigator.clipboard || !window.ClipboardItem) return false;
        const res = await fetch(abs, { cache: "no-store" });
        const blob = await res.blob();
        const type = blob.type || "image/png";
        const item = new ClipboardItem({ [type]: blob });
        await navigator.clipboard.write([item]);
        return true;
      }catch(e){
        return false;
      }
    }

    function isProbablyImage(url){
      return /\.(png|jpe?g|webp|gif)(\?.*)?$/i.test(String(url||""));
    }

    function absUrl(pathOrUrl){
      const s = String(pathOrUrl || "");
      if(!s) return "";
      try{ return new URL(s, BASE_ORIGIN).toString(); }
      catch(e){ return s; }
    }

    function extractPromoUrl(it){
      if(it && it.source_url && isProbablyImage(it.source_url)) return it.source_url;
      const ms = String(it && it.message_short || "");
      const ml = String(it && it.message_long || "");
      const m = (ms + "\n" + ml).match(/\/assets\/images\/[^\s\n]+\.(?:png|jpe?g|webp|gif)/i);
      return m ? m[0] : "";
    }

    const SOCIAL_ICON = {
      "Instagram": "/assets/images/icons/MBW-IG.png",
      "TikTok": "/assets/images/icons/MBW-Social-TikTok.png",
      "Facebook": "/assets/images/icons/MBW-Social-FB-01.png",
      "YouTube": "/assets/images/icons/MBW-Social-YouTube.png",
      "Shop": "/assets/images/icons/MBW-Social-Shopify.png",
      "Gift Shop": "/assets/images/icons/MBW-Social-Shopify.png",
      "Google Reviews": "/assets/images/icons/Google-Review-Symbol.png",
      "Google Review Link": "/assets/images/icons/Google-Review-Symbol.png"
    };

    const els = {
      langEn: $("langEn"),
      langEs: $("langEs"),
      status: $("statusChip"),
      count: $("count"),
      subject: $("subjectSel"),
      topic: $("topicSel"),
      q: $("q"),
      list: $("list"),
      detailTitle: $("detailTitle"),
      blocks: $("blocks"),
      copyBooking: $("copyBookingLink"),
      subjectLabel: $("subjectLabel"),
      topicLabel: $("topicLabel"),
      searchLabel: $("searchLabel"),
      hint: $("hint"),
      reservationsLine: $("reservationsLine"),
      quickTip: $("quickTip"),
      quickTitle: $("quickTitle"),
      langLabel: $("langLabel")
    };

    const state = {
      lang: "en",
      db: null,
      items: [],
      selectedId: null,
      lastSubject: "__all__"
    };

    function setLang(lang){
      state.lang = lang;
      els.langEn.setAttribute("aria-pressed", lang === "en" ? "true" : "false");
      els.langEs.setAttribute("aria-pressed", lang === "es" ? "true" : "false");

      // UI labels
      if(lang === "es"){
        els.langLabel.textContent = "Idioma";
        els.subjectLabel.textContent = "Categoria";
        els.topicLabel.textContent = "Tema";
        els.searchLabel.textContent = "Buscar";
        els.q.placeholder = "Buscar titulos...";
        els.hint.textContent = "Consejo: elige una categoria y toca Copiar para enviar una respuesta rapida.";
        els.quickTitle.textContent = "Acciones rapidas";
        els.copyBooking.textContent = "Copiar enlace de reserva";
        els.quickTip.textContent = "Si un cliente pregunta por precios, confirma la fecha y el tamano del grupo.";
      }else{
        els.langLabel.textContent = "Language";
        els.subjectLabel.textContent = "Subject";
        els.topicLabel.textContent = "Topic";
        els.searchLabel.textContent = "Search";
        els.q.placeholder = "Search titles...";
        els.hint.textContent = "Tip: select a subject, then tap Copy to send a quick reply.";
        els.quickTitle.textContent = "Quick actions";
        els.copyBooking.textContent = "Copy booking link";
        els.quickTip.textContent = "If a guest asks for prices, confirm the date and group size.";
      }

      updateBookingLink();
      buildSubjectOptions();
      buildTopicOptions();
      render(true);
    }

    function updateBookingLink(){
      const path = state.lang === "es" ? "/es/reservar-tour/" : "/book-a-tour/";
      els.copyBooking.dataset.url = absUrl(path);
    }

    function getLangBucket(){
      return state.db && state.db.languages ? (state.db.languages[state.lang] || null) : null;
    }

    function subjects(){
      const b = getLangBucket();
      if(!b) return [];
      return Object.keys(b).sort((a,b2)=>a.localeCompare(b2));
    }

    function topicsForSubject(subject){
      const b = getLangBucket();
      if(!b || !b[subject]) return [];
      return Object.keys(b[subject]).sort((a,b2)=>a.localeCompare(b2));
    }

    function itemsFor(subject, topic){
      const b = getLangBucket();
      if(!b || !b[subject] || !b[subject][topic]) return [];
      const arr = b[subject][topic] || [];
      return arr.map((it, idx) => {
        const id = (it && (it.id !== undefined && it.id !== null)) ? String(it.id) : (subject + "|" + topic + "|" + idx);
        return Object.assign({}, it, { _id: id, _subject: subject, _topic: topic });
      });
    }

    function buildSubjectOptions(){
      const subs = subjects();
      els.subject.innerHTML = "";

      const allOpt = document.createElement("option");
      allOpt.value = "__all__";
      allOpt.textContent = (state.lang === "es") ? "Todas" : "All";
      els.subject.appendChild(allOpt);

      subs.forEach(s => {
        const o = document.createElement("option");
        o.value = s;
        o.textContent = s;
        els.subject.appendChild(o);
      });

      // keep last selected if possible
      const keep = (state.lastSubject && (state.lastSubject === "__all__" || subs.includes(state.lastSubject))) ? state.lastSubject : "__all__";
      els.subject.value = keep;
    }

    function buildTopicOptions(){
      const subject = els.subject.value || "__all__";
      state.lastSubject = subject;

      els.topic.innerHTML = "";
      const o0 = document.createElement("option");
      o0.value = "__all__";
      o0.textContent = (state.lang === "es") ? "Todos" : "All";
      els.topic.appendChild(o0);

      if(subject !== "__all__"){
        topicsForSubject(subject).forEach(t => {
          const o = document.createElement("option");
          o.value = t;
          o.textContent = t;
          els.topic.appendChild(o);
        });
      }

      els.topic.value = "__all__";
    }

    function currentItems(){
      const q = (els.q.value || "").trim().toLowerCase();
      const subject = els.subject.value || "__all__";
      const topic = els.topic.value || "__all__";

      let out = [];

      const b = getLangBucket();
      if(!b) return out;

      function addSubject(s){
        const ts = topicsForSubject(s);
        ts.forEach(t => {
          if(topic !== "__all__" && t !== topic) return;
          out = out.concat(itemsFor(s, t));
        });
      }

      if(subject === "__all__"){
        subjects().forEach(addSubject);
      }else{
        addSubject(subject);
      }

      // Search filter
      if(q){
        out = out.filter(it => {
          const hay = (it.title || "") + " " + (it.subtopic || "") + " " + (it.message_short || "") + " " + (it.message_long || "");
          return hay.toLowerCase().includes(q);
        });
      }

      // Sort with stable order (subject/topic/title)
      out.sort((a,b2) => {
        const as = (a._subject || "").localeCompare(b2._subject || "");
        if(as) return as;
        const at = (a._topic || "").localeCompare(b2._topic || "");
        if(at) return at;
        return (a.title || "").localeCompare(b2.title || "");
      });

      // Always add a synthetic Social Links "item" at top
      out.unshift({ _id: "__social__", title: (state.lang==="es" ? "Enlaces sociales" : "Social links"), _subject: "Social", _topic: "Links", _synthetic: true });

      return out;
    }

    function render(resetSelection){
      state.items = currentItems();
      els.count.textContent = String(Math.max(0, state.items.length - 1)); // exclude synthetic from count

      if(!state.items.length){
        els.list.innerHTML = "<div class=\"empty\">" + esc(state.lang==="es" ? "Sin resultados." : "No results.") + "</div>";
        state.selectedId = null;
        renderDetail();
        return;
      }

      if(resetSelection){
        state.selectedId = state.items[0]._id;
      }else{
        if(!state.items.some(x => x._id === state.selectedId)){
          state.selectedId = state.items[0]._id;
        }
      }

      els.list.innerHTML = state.items.map(it => {
        const active = it._id === state.selectedId;
        const meta = it._synthetic ? (state.lang==="es" ? "Iconos + botones de copiar" : "Icons + copy buttons") : ((it._subject || "") + " / " + (it._topic || ""));
        return (
          "<button class=\"itemBtn\" type=\"button\" data-item=\"" + esc(it._id) + "\" aria-current=\"" + (active ? "true" : "false") + "\">" +
            "<p class=\"itemTitle\">" + esc(it.title || "") + "</p>" +
            "<p class=\"itemMeta\">" + esc(meta) + "</p>" +
          "</button>"
        );
      }).join("");

      renderDetail();
    }

    function getSocialLinksForLang(){
      const bucket = getLangBucket();
      if(!bucket || !bucket.Social || !bucket.Social.Links) return [];
      const links = bucket.Social.Links || [];
      // normalize (title = label, message_short = url or source_url)
      return links.map(it => ({
        label: it.title || it.label || "",
        url: it.source_url || it.message_short || it.url || ""
      })).filter(x => x.label && x.url);
    }

    function renderDetail(){
      const it = state.items.find(x => x._id === state.selectedId) || null;

      if(!it){
        els.detailTitle.textContent = state.lang === "es" ? "Selecciona un elemento" : "Select an item";
        els.blocks.innerHTML = "";
        return;
      }

      els.detailTitle.textContent = it.title || "";

      const parts = [];

      if(it._id === "__social__"){
        const links = getSocialLinksForLang();
        if(!links.length){
          parts.push("<div class=\"block\"><div class=\"txt\">" + esc(state.lang==="es" ? "No hay enlaces." : "No links.") + "</div></div>");
        }else{
          const rows = links.map(l => {
            const icon = SOCIAL_ICON[l.label] || "/assets/images/icons/MBW-IG.png";
            return (
              "<div class=\"socialRow\">" +
                "<div class=\"socialLeft\">" +
                  "<img class=\"socialIcon\" src=\"" + esc(icon) + "\" alt=\"" + esc(l.label) + "\" loading=\"lazy\" decoding=\"async\">" +
                  "<div class=\"socialName\">" + esc(l.label) + "</div>" +
                "</div>" +
                "<button class=\"copyBtn\" type=\"button\" data-copy=\"" + esc(l.url) + "\">" + esc(state.lang==="es" ? "Copiar" : "Copy") + "</button>" +
              "</div>"
            );
          }).join("");

          parts.push(
            "<div class=\"block\">" +
              "<div class=\"blockHead\"><div class=\"blockTitle\">" + esc(state.lang==="es" ? "Enlaces" : "Links") + "</div>" +
                "<button class=\"copyBtn\" type=\"button\" data-copy-all-social=\"1\">" + esc(state.lang==="es" ? "Copiar todos" : "Copy all") + "</button>" +
              "</div>" +
              "<div class=\"socialGrid\">" + rows + "</div>" +
            "</div>"
          );
        }

        els.blocks.innerHTML = parts.join("");
        return;
      }

      // Short reply
      if(it.message_short){
        parts.push(
          "<div class=\"block\">" +
            "<div class=\"blockHead\">" +
              "<div class=\"blockTitle\">" + esc(state.lang==="es" ? "Respuesta corta" : "Short reply") + "</div>" +
              "<button class=\"copyBtn\" type=\"button\" data-copy=\"" + esc(it.message_short) + "\">" + esc(state.lang==="es" ? "Copiar" : "Copy") + "</button>" +
            "</div>" +
            "<p class=\"txt\">" + esc(it.message_short) + "</p>" +
          "</div>"
        );
      }

      // Detailed reply
      if(it.message_long){
        parts.push(
          "<div class=\"block\">" +
            "<div class=\"blockHead\">" +
              "<div class=\"blockTitle\">" + esc(state.lang==="es" ? "Respuesta detallada" : "Detailed reply") + "</div>" +
              "<button class=\"copyBtn\" type=\"button\" data-copy=\"" + esc(it.message_long) + "\">" + esc(state.lang==="es" ? "Copiar" : "Copy") + "</button>" +
            "</div>" +
            "<p class=\"txt\">" + esc(it.message_long) + "</p>" +
          "</div>"
        );
      }

      // Promo image (show image + copy link + copy image)
      const promo = extractPromoUrl(it);
      if(promo){
        const abs = absUrl(promo);
        parts.push(
          "<div class=\"block\">" +
            "<div class=\"blockHead\">" +
              "<div class=\"blockTitle\">" + esc(state.lang==="es" ? "Imagen promocional" : "Promo image") + "</div>" +
              "<div class=\"promoBtnRow\">" +
                "<button class=\"copyBtn\" type=\"button\" data-copy=\"" + esc(abs) + "\">" + esc(state.lang==="es" ? "Copiar enlace" : "Copy link") + "</button>" +
                "<button class=\"copyBtn\" type=\"button\" data-copy-image=\"" + esc(promo) + "\">" + esc(state.lang==="es" ? "Copiar imagen" : "Copy image") + "</button>" +
              "</div>" +
            "</div>" +
            "<figure class=\"promoFigure\">" +
              "<img class=\"promoImg\" src=\"" + esc(promo) + "\" alt=\"" + esc(it.title || "Promo image") + "\" loading=\"lazy\" decoding=\"async\">" +
              "<p class=\"note\">" + esc(state.lang==="es" ? "Si Copiar imagen no funciona en tu telefono, abre la imagen y manten presionada para copiar/guardar." : "If Copy image does not work on your phone, open the image and press and hold to copy/save.") + "</p>" +
            "</figure>" +
          "</div>"
        );
      }

      if(!parts.length){
        parts.push("<div class=\"block\"><p class=\"txt\">" + esc(state.lang==="es" ? "Sin contenido." : "No content.") + "</p></div>");
      }

      els.blocks.innerHTML = parts.join("");
    }

    // ---------- events ----------
    els.langEn.addEventListener("click", () => setLang("en"));
    els.langEs.addEventListener("click", () => setLang("es"));

    els.copyBooking.addEventListener("click", async () => {
      const url = els.copyBooking.dataset.url || "";
      const ok = await copyText(url);
      toast(ok ? (state.lang==="es" ? "Enlace copiado" : "Link copied") : (state.lang==="es" ? "No se pudo copiar" : "Copy failed"));
    });

    els.subject.addEventListener("change", () => {
      buildTopicOptions();
      render(true);
    });
    els.topic.addEventListener("change", () => render(true));
    els.q.addEventListener("input", () => render(false));

    document.addEventListener("click", async (e) => {
      const itemBtn = e.target.closest("[data-item]");
      if(itemBtn){
        state.selectedId = itemBtn.getAttribute("data-item");
        render(false);
        return;
      }

      const copyBtn = e.target.closest("[data-copy]");
      if(copyBtn){
        const txt = copyBtn.getAttribute("data-copy");
        const ok = await copyText(txt);
        toast(ok ? (state.lang==="es" ? "Copiado" : "Copied") : (state.lang==="es" ? "No se pudo copiar" : "Copy failed"));
        return;
      }

      const copyImgBtn = e.target.closest("[data-copy-image]");
      if(copyImgBtn){
        const url = copyImgBtn.getAttribute("data-copy-image");
        const ok = await copyImage(url);
        if(ok){
          toast(state.lang==="es" ? "Imagen copiada" : "Image copied");
        }else{
          const abs = absUrl(url);
          await copyText(abs);
          toast(state.lang==="es" ? "No se pudo copiar la imagen. Enlace copiado." : "Could not copy image. Link copied.");
        }
        return;
      }

      const copyAll = e.target.closest("[data-copy-all-social]");
      if(copyAll){
        const links = getSocialLinksForLang();
        const lines = links.map(l => l.label + ": " + l.url).join("\n");
        const ok = await copyText(lines);
        toast(ok ? (state.lang==="es" ? "Copiado" : "Copied") : (state.lang==="es" ? "No se pudo copiar" : "Copy failed"));
        return;
      }
    });

    // ---------- load ----------
    (async function init(){
      try{
        const res = await fetch(DATA_URL, { cache: "no-store" });
        if(!res.ok) throw new Error("fetch failed");
        const db = await res.json();
        state.db = db;
        els.status.textContent = (state.lang==="es" ? "Listo" : "Ready");
        buildSubjectOptions();
        buildTopicOptions();
        setLang(state.lang);
      }catch(err){
        els.status.textContent = (state.lang==="es" ? "Error" : "Error");
        els.list.innerHTML = "<div class=\"empty\">" + esc(state.lang==="es" ? "No se pudo cargar staff-content.json" : "Could not load staff-content.json") + "</div>";
        console.error(err);
      }
    })();
  })();
  </script>

  <script>
    (function(){
      async function inject(id, url){
        const el = document.getElementById(id);
        if(!el) return;
        const res = await fetch(url, { cache: "no-store" });
        el.innerHTML = await res.text();
      }
      function loadScript(src){
        return new Promise((resolve, reject) => {
          const s = document.createElement("script");
          s.src = src;
          s.defer = true;
          s.onload = resolve;
          s.onerror = reject;
          document.body.appendChild(s);
        });
      }
      (async function(){
        await inject("siteHeader", "/assets/includes/header.html");
        await inject("siteFooter", "/assets/includes/footer.html");
        await loadScript("/assets/js/site.js");
      })();
    })();
  </script>
</body>
</html>
