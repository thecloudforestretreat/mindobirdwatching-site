<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Plan Your Trip to Mindo | Mindo Bird Watching</title>
  <meta name="description" content="Plan your trip to Mindo with a simple, step-by-step flow. Choose trip length, decide what to book first, and build an easy day-by-day outline for birding and nature." />
  <link rel="canonical" href="https://mindobirdwatching.com/plan-your-trip/mindo/" />
  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Mindo Bird Watching" />
  <meta property="og:title" content="Plan Your Trip to Mindo | Mindo Bird Watching" />
  <meta property="og:description" content="Plan your trip to Mindo with a simple, step-by-step flow. Choose trip length, decide what to book first, and build an easy day-by-day outline for birding and nature." />
  <meta property="og:url" content="https://mindobirdwatching.com/plan-your-trip/mindo/" />
  <meta property="og:image" content="https://staging.mindobirdwatching.com/MBW-Assets-OG-Image.png" />
  <meta property="og:image:secure_url" content="https://staging.mindobirdwatching.com/MBW-Assets-OG-Image.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="Plan your trip to Mindo with a simple, step-by-step guide" />
  <!-- Twitter / X -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Plan Your Trip to Mindo | Mindo Bird Watching" />
  <meta name="twitter:description" content="Plan your trip to Mindo with a simple, step-by-step flow. Choose trip length, decide what to book first, and build an easy day-by-day outline for birding and nature." />
  <meta name="twitter:image" content="https://staging.mindobirdwatching.com/MBW-Assets-OG-Image.png" />
  <link rel="alternate" hreflang="en" href="/plan-your-trip/mindo/" />
  <link rel="alternate" hreflang="es" href="/es/plan-your-trip/mindo/" />
  <link rel="alternate" hreflang="x-default" href="/plan-your-trip/mindo/" />
  <!-- Favicons (approved root paths) -->
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#034EA2">
  <!-- Global / shared CSS -->
  <link rel="stylesheet" href="/assets/css/site.css">
  <link rel="stylesheet" href="/assets/css/header.css?v=1">
  <!-- Head-only JS -->
  <script src="/assets/js/head.js" defer></script>
  <style>
    /* Page-only styles only (ASCII only) */
.page{
  margin-top:18px;
  padding:26px;
}
.page.card{
  background: var(--card);
  border: 1px solid var(--line);
  border-radius: var(--r);
  box-shadow: var(--shadow);
}

.crumbs{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  align-items:center;
  color: var(--muted);
  font-size: 13px;
  margin-bottom: 10px;
}
.crumbs a{
  color: var(--ink);
  font-weight: 900;
  text-decoration: none;
  border-bottom: 1px solid rgba(0,0,0,0.14);
}
.crumbs a:hover{ border-bottom-color: rgba(0,0,0,0.30); }

.hero{
  display:grid;
  grid-template-columns: 1.2fr 0.8fr;
  gap: 16px;
  align-items:stretch;
  margin-top: 10px;
}
@media (max-width: 900px){
  .hero{ grid-template-columns: 1fr; }
}

.heroMain{
  background: rgba(255,255,255,.65);
  border: 1px solid var(--line);
  border-radius: var(--r);
  box-shadow: var(--shadow);
  padding: 18px;
  min-width:0;
}

.heroTitle{
  margin: 0 0 8px;
  font-family: var(--font-head);
  color: var(--forest);
  letter-spacing: -0.02em;
  font-size: 28px;
  line-height: 1.15;
}

.heroLede{
  margin: 0;
  color: var(--muted);
  line-height: 1.65;
  max-width: 85ch;
}

.quickFacts{
  background: rgba(255,255,255,.65);
  border: 1px solid var(--line);
  border-radius: var(--r);
  box-shadow: var(--shadow);
  padding: 16px;
  min-width:0;
  display:flex;
  flex-direction:column;
  gap: 10px;
}

.factsTitle{
  margin: 0 0 6px;
  font-family: var(--font-head);
  color: var(--forest);
  letter-spacing: -0.02em;
  font-size: 18px;
}

.factGrid{
  display:grid;
  grid-template-columns: 1fr;
  gap: 10px;
}

.fact{
  border: 1px solid var(--line);
  background: rgba(255,255,255,.72);
  border-radius: 14px;
  padding: 12px;
}
.fact strong{
  display:block;
  color: var(--ink);
  font-weight: 900;
  margin-bottom: 4px;
}
.fact span{
  color: var(--muted);
  line-height: 1.5;
  font-size: 13.5px;
  display:block;
}

.ctaRow{
  display:flex;
  flex-wrap:wrap;
  gap: 10px;
  margin-top: 14px;
  align-items:center;
}

.btnTertiary{
  display:inline-flex;
  align-items:center;
  gap: 8px;
  font-weight: 900;
  color: var(--ink);
  text-decoration:none;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid var(--line);
  background: rgba(255,255,255,.65);
  box-shadow: var(--shadow);
}
.btnTertiary:hover{
  background: rgba(255,255,255,.82);
}

.section{
  margin-top: 18px;
}

.sectionTitle{
  margin: 0 0 10px;
  font-family: var(--font-head);
  color: var(--forest);
  letter-spacing: -0.02em;
  font-size: 20px;
}

.stepGrid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
  align-items:stretch;
}
@media (max-width: 900px){
  .stepGrid{ grid-template-columns: 1fr; }
}

.stepCard{
  background: rgba(255,255,255,.65);
  border: 1px solid var(--line);
  border-radius: var(--r);
  box-shadow: var(--shadow);
  padding: 16px;
  display:flex;
  flex-direction:column;
  gap: 10px;
  min-width:0;
}

.stepTop{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap: 10px;
  flex-wrap:wrap;
}

.stepTitle{
  margin:0;
  font-family: var(--font-head);
  color: var(--forest);
  letter-spacing: -0.02em;
  font-size: 18px;
  line-height: 1.2;
}

.badge{
  display:inline-flex;
  align-items:center;
  gap: 6px;
  padding: 7px 10px;
  border-radius: 999px;
  border: 1px solid var(--line);
  background: rgba(255,255,255,.75);
  font-weight: 900;
  font-size: 12px;
  color: var(--ink);
  white-space:nowrap;
}

.stepDesc{
  margin:0;
  color: var(--muted);
  line-height: 1.6;
}

.miniList{
  margin: 0;
  padding-left: 18px;
  color: var(--muted);
  line-height: 1.55;
}
.miniList li{ margin: 4px 0; }

.stepActions{
  margin-top:auto;
  display:flex;
  flex-wrap:wrap;
  gap: 10px;
  align-items:center;
}

.divider{
  margin-top: 18px;
  border-top: 1px solid var(--line);
  padding-top: 18px;
}

.twoCol{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
  align-items:stretch;
}
@media (max-width: 900px){
  .twoCol{ grid-template-columns: 1fr; }
}

.callout{
  background: rgba(255,255,255,.65);
  border: 1px solid var(--line);
  border-radius: var(--r);
  box-shadow: var(--shadow);
  padding: 16px;
  min-width:0;
}

.callout h3{
  margin:0 0 8px;
  font-family: var(--font-head);
  color: var(--forest);
  letter-spacing: -0.02em;
  font-size: 18px;
}
.callout p{
  margin: 0 0 10px;
  color: var(--muted);
  line-height: 1.6;
}

.softCard{
  border: 1px solid var(--line);
  background: rgba(255,255,255,.72);
  border-radius: 14px;
  padding: 12px;
  margin-top: 10px;
}

.softCard strong{
  display:block;
  color: var(--ink);
  font-weight: 900;
  margin-bottom: 4px;
}
.softCard span{
  color: var(--muted);
  line-height: 1.5;
  font-size: 13.5px;
  display:block;
}

.noteLine{
  margin-top: 10px;
  padding-top: 12px;
  border-top: 1px solid var(--line);
  color: var(--muted);
  font-size: 13px;
  line-height: 1.5;
}
.noteLine a{
  color: var(--ink);
  font-weight: 900;
  text-decoration: underline;
  text-underline-offset: 3px;
}

/* Trip builder (page-only) */
.builder{
  background: rgba(255,255,255,.65);
  border: 1px solid var(--line);
  border-radius: var(--r);
  box-shadow: var(--shadow);
  padding: 16px;
  min-width:0;
}
.builderTop{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap: 12px;
  flex-wrap:wrap;
  margin-bottom: 10px;
}
.builderTitle{
  margin:0;
  font-family: var(--font-head);
  color: var(--forest);
  letter-spacing: -0.02em;
  font-size: 20px;
}
.builderLede{
  margin: 6px 0 0;
  color: var(--muted);
  line-height: 1.6;
  max-width: 90ch;
}
.builderGrid{
  display:grid;
  grid-template-columns: 0.9fr 1.1fr;
  gap: 14px;
  align-items:start;
  margin-top: 12px;
}
@media (max-width: 900px){
  .builderGrid{ grid-template-columns: 1fr; }
}

.field{
  display:flex;
  flex-direction:column;
  gap: 6px;
  margin-bottom: 10px;
}
.field label{
  font-size: 13px;
  font-weight: 900;
  color: var(--ink);
}
.field select,
.field input,
.field textarea{
  font: inherit;
  padding: 11px 12px;
  border-radius: 14px;
  border: 1px solid var(--line);
  background: rgba(255,255,255,.78);
  box-shadow: var(--shadow);
  color: var(--ink);
  outline: none;
}
.field textarea{
  min-height: 220px;
  resize: vertical;
  line-height: 1.55;
}

.chips{
  display:flex;
  flex-wrap:wrap;
  gap: 8px;
  margin-top: 6px;
}
.chip{
  display:inline-flex;
  align-items:center;
  gap: 8px;
  padding: 8px 10px;
  border-radius: 999px;
  border: 1px solid var(--line);
  background: rgba(255,255,255,.75);
  box-shadow: var(--shadow);
  cursor:pointer;
  user-select:none;
}
.chip input{
  width: 16px;
  height: 16px;
  accent-color: #0d5925;
}
.chip span{
  font-size: 13px;
  font-weight: 900;
  color: var(--ink);
  line-height: 1;
}

.builderActions{
  display:flex;
  flex-wrap:wrap;
  gap: 10px;
  align-items:center;
  margin-top: 10px;
}

.mutedSmall{
  color: var(--muted);
  font-size: 13px;
  line-height: 1.5;
}

.builderStatus{
  margin-top: 10px;
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid var(--line);
  background: rgba(255,255,255,.72);
  color: var(--muted);
  font-size: 13px;
  line-height: 1.5;
}

.inviteBox{
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--line);
  display:none;
}
.inviteGrid{
  display:grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 10px;
}
@media (max-width: 900px){
  .inviteGrid{ grid-template-columns: 1fr; }
}
      </style>
</head>
<body>
  <div class="container">
    <div id="siteHeader"></div>
<main class="page card">
  <nav class="crumbs" aria-label="Breadcrumb">
    <a href="/">Home</a>
    <span aria-hidden="true">/</span>
    <a href="/plan-your-trip/">Plan Your Trip</a>
    <span aria-hidden="true">/</span>
    <span>Plan Your Trip to Mindo</span>
  </nav>
  <section class="hero" aria-label="Plan your trip to Mindo hero">
    <div class="heroMain">
      <h1 class="heroTitle">Plan Your Trip to Mindo</h1>
      <p class="heroLede">
        Use this simple flow to decide trip length, what to book first, and how to build a day-by-day outline that fits your pace. If you want, we can also help you match arrival times to early birding mornings.
      </p>
  <div class="ctaRow" aria-label="Primary actions">
    <a class="btn primary" href="/tours/">Browse Tours</a>
    <a class="btn secondary" href="/transportation/">Transportation</a>
    <a class="btnTertiary" href="https://wa.me/13054585402" target="_blank" rel="noopener">Ask on WhatsApp</a>
  </div>

  <div class="noteLine">
    Short on time? Tell us your dates and goals and we will recommend a simple plan.
    <a href="https://wa.me/13054585402" target="_blank" rel="noopener">Message us</a>
  </div>
</div>

<aside class="quickFacts" aria-label="Quick facts">
  <h2 class="factsTitle">Quick Facts</h2>
  <div class="factGrid">
    <div class="fact">
      <strong>Best For</strong>
      <span>Birding, cloud forest, waterfalls, chocolate, and easy nature days from Quito.</span>
    </div>
    <div class="fact">
      <strong>Getting Here</strong>
      <span>Most travelers land in Quito (UIO) and transfer by private driver or shared van.</span>
    </div>
    <div class="fact">
      <strong>Trip Length</strong>
      <span>2 to 4 nights is a great starting point. Longer stays work well for photography pacing.</span>
    </div>
  </div>
</aside>
  </section>
  <section class="section" aria-label="Trip builder">
    <div class="builder" id="tripBuilder" data-endpoint="">
      <div class="builderTop">
        <div>
          <h2 class="builderTitle">Build a Simple Itinerary</h2>
          <p class="builderLede">
            Pick your trip length and interests. We will draft a day-by-day outline you can copy, share, or email to your travel group.
          </p>
        </div>
        <span class="badge" aria-label="Builder status badge">Fast Draft</span>
      </div>
  <div class="builderGrid" aria-label="Trip builder form and output">
    <div aria-label="Builder controls">
      <div class="field">
        <label for="tripDays">Trip length (days)</label>
        <select id="tripDays">
          <option value="2">2 days</option>
          <option value="3" selected>3 days</option>
          <option value="4">4 days</option>
          <option value="5">5 days</option>
          <option value="6">6 days</option>
          <option value="7">7 days</option>
        </select>
      </div>

      <div class="field" aria-label="Interests">
        <label>What are you most excited about?</label>
        <div class="chips" id="interestChips">
          <label class="chip"><input type="checkbox" value="birding" checked><span>Birding</span></label>
          <label class="chip"><input type="checkbox" value="waterfalls"><span>Waterfalls</span></label>
          <label class="chip"><input type="checkbox" value="chocolate"><span>Chocolate</span></label>
          <label class="chip"><input type="checkbox" value="hummingbirds"><span>Hummingbirds</span></label>
          <label class="chip"><input type="checkbox" value="photography"><span>Photography</span></label>
          <label class="chip"><input type="checkbox" value="adventure"><span>Adventure</span></label>
          <label class="chip"><input type="checkbox" value="relaxed"><span>Relaxed pace</span></label>
          <label class="chip"><input type="checkbox" value="night"><span>Night walk</span></label>
        </div>
        <div class="mutedSmall" style="margin-top:8px;">
          Tip: If you choose Birding, we will anchor mornings with guided birding blocks.
        </div>
      </div>

      <div class="builderActions" aria-label="Builder actions">
        <button class="btn primary" id="btnGenerate" type="button">Generate itinerary</button>
        <button class="btn secondary" id="btnCopy" type="button">Copy</button>
        <button class="btn tertiary" id="btnEmailToggle" type="button">Email this</button>
      </div>

      <div class="inviteBox" id="inviteBox" aria-label="Email itinerary form">
        <div class="field">
          <label for="primaryEmail">Your email</label>
          <input id="primaryEmail" type="email" placeholder="you@email.com" autocomplete="email">
        </div>

        <div class="inviteGrid" aria-label="Invite up to 3 travelers">
          <div class="field">
            <label for="t1Email">Traveler 1 email</label>
            <input id="t1Email" type="email" placeholder="traveler1@email.com">
          </div>
          <div class="field">
            <label for="t2Email">Traveler 2 email</label>
            <input id="t2Email" type="email" placeholder="traveler2@email.com">
          </div>
          <div class="field">
            <label for="t3Email">Traveler 3 email</label>
            <input id="t3Email" type="email" placeholder="traveler3@email.com">
          </div>
        </div>

        <div class="builderActions" style="margin-top:12px;">
          <button class="btn primary" id="btnSendEmail" type="button">Send email</button>
          <a class="btn secondary" href="https://wa.me/13054585402" target="_blank" rel="noopener">Ask us to refine it</a>
        </div>

        <div class="mutedSmall" style="margin-top:10px;">
          Note: To enable email sending, set the web app endpoint in the builder's data-endpoint attribute.
        </div>
      </div>

      <div class="builderStatus" id="builderStatus" role="status" aria-live="polite">
        Loading itinerary blocks...
      </div>
    </div>

    <div aria-label="Itinerary output">
      <div class="field">
        <label for="itineraryOutput">Your draft itinerary</label>
        <textarea id="itineraryOutput" placeholder="Click Generate itinerary to build a day-by-day outline."></textarea>
      </div>
      <div class="mutedSmall">
        You can edit this text before you copy or email it.
      </div>
    </div>
  </div>
</div>
  </section>
  <section class="section" aria-label="Step by step planning">
    <h2 class="sectionTitle">Step-by-Step Planning</h2>
<div class="stepGrid" aria-label="Planning steps">
  <article class="stepCard" aria-label="Step 1 trip length">
    <div class="stepTop">
      <h3 class="stepTitle">1) Choose your trip length</h3>
      <span class="badge">Start Here</span>
    </div>
    <p class="stepDesc">
      Pick a trip length based on your energy level and how many early mornings you want.
    </p>
    <ul class="miniList" aria-label="Trip length options">
      <li><strong>2 Nights:</strong> highlights and one strong birding morning</li>
      <li><strong>3 Nights:</strong> best balance for birding plus relaxed afternoons</li>
      <li><strong>4+ Nights:</strong> slow pacing for photography and target species</li>
    </ul>
    <div class="stepActions">
      <a class="btn primary" href="/tours/">Pick A Tour</a>
      <a class="btn secondary" href="/activities/">Add Activities</a>
    </div>
  </article>

  <article class="stepCard" aria-label="Step 2 what to book first">
    <div class="stepTop">
      <h3 class="stepTitle">2) Book the right things first</h3>
      <span class="badge">Quick Wins</span>
    </div>
    <p class="stepDesc">
      Lock the items that affect your mornings. Everything else can stay flexible.
    </p>
    <ul class="miniList" aria-label="Booking priority">
      <li>Guided birding mornings (best guides book first)</li>
      <li>Lodging close to your start point</li>
      <li>Transportation that matches your arrival time</li>
    </ul>
    <div class="stepActions">
      <a class="btn primary" href="/tours/">See Tour Options</a>
      <a class="btn secondary" href="/transportation/">Plan Transfers</a>
    </div>
  </article>

  <article class="stepCard" aria-label="Step 3 day by day outline">
    <div class="stepTop">
      <h3 class="stepTitle">3) Draft a simple day-by-day outline</h3>
      <span class="badge">Easy pacing</span>
    </div>
    <p class="stepDesc">
      Mindo works best with early birding, relaxed midday, and a second light activity later.
    </p>
    <ul class="miniList" aria-label="Outline idea">
      <li>Morning: birding or photo session</li>
      <li>Midday: rest, lunch, chocolate, or a short nature walk</li>
      <li>Afternoon: waterfall or garden visit</li>
    </ul>
    <div class="stepActions">
      <a class="btn primary" href="/activities/">Build Your Days</a>
      <a class="btn secondary" href="/tours/">Add A Guided Morning</a>
    </div>
  </article>

  <article class="stepCard" aria-label="Step 4 arrivals and transportation">
    <div class="stepTop">
      <h3 class="stepTitle">4) Match arrival to your first morning</h3>
      <span class="badge">No Stress</span>
    </div>
    <p class="stepDesc">
      If you want a strong first morning, aim to arrive with time to transfer in daylight.
    </p>
    <ul class="miniList" aria-label="Arrival tips">
      <li>Prefer Quito (UIO) for fastest access</li>
      <li>Plan your transfer so you can settle in before dark</li>
      <li>Tell us your flight time and we will recommend pickup timing</li>
    </ul>
    <div class="stepActions">
      <a class="btn primary" href="/transportation/">Transportation Options</a>
      <a class="btn secondary" href="https://wa.me/13054585402" target="_blank" rel="noopener">Send Flight Details</a>
    </div>
  </article>
</div>
  </section>
  <section class="section divider" aria-label="Recommended plans">
    <h2 class="sectionTitle">Recommended Sample Plans</h2>
<div class="twoCol" aria-label="Sample plans">
  <div class="callout" aria-label="2 night plan">
    <h3>2 Nights (highlights)</h3>
    <p>
      Great if you want one strong birding morning plus a relaxed nature afternoon.
    </p>
    <div class="softCard">
      <strong>Example Outline</strong>
      <span>Day 1: arrive + easy sunset activity. Day 2: guided birding morning + waterfalls. Day 3: breakfast + transfer.</span>
    </div>
    <div class="ctaRow">
      <a class="btn primary" href="/tours/">Choose A Tour</a>
      <a class="btn secondary" href="/transportation/">Book Pickup</a>
    </div>
  </div>

  <div class="callout" aria-label="3 to 4 night plan">
    <h3>3 to 4 Nights (best balance)</h3>
    <p>
      Ideal for birders who want more than one early morning and time for photography pacing.
    </p>
    <div class="softCard">
      <strong>Example Outline</strong>
      <span>Two birding mornings, one flexible activity day, plus a relaxed final morning before departure.</span>
    </div>
    <div class="ctaRow">
      <a class="btn primary" href="/tours/">See Birding Tours</a>
      <a class="btn secondary" href="/activities/">Add Activities</a>
    </div>
  </div>
</div>

<div class="noteLine">
  Want a custom plan? Message us your dates, hotel (if known), and goals.
  <a href="https://wa.me/13054585402" target="_blank" rel="noopener">Ask on WhatsApp</a>
</div>
  </section>
  <section class="section divider" aria-label="More planning links">
    <h2 class="sectionTitle">More Planning Help</h2>
<div class="twoCol" aria-label="More links">
  <div class="callout">
    <h3>Flights and arrivals</h3>
    <p>Use the main Plan Your Trip page to quickly check flights and then coordinate your transfer.</p>
    <div class="ctaRow">
      <a class="btn primary" href="/plan-your-trip/">Open Flight Tool</a>
      <a class="btn secondary" href="/transportation/">Transportation</a>
    </div>
  </div>

  <div class="callout">
    <h3>Birding-first planning</h3>
    <p>If you want a birding-only flow, use the birding days page and we will help you sequence mornings.</p>
    <div class="ctaRow">
      <a class="btn primary" href="/plan-your-trip/mindo-birding/">Plan Birding Days</a>
      <a class="btn secondary" href="/tours/">Browse Tours</a>
    </div>
  </div>
</div>
  </section>
</main>
<div id="siteFooter"></div>
  </div>
  <!-- Trip builder logic (page-only) -->
  <script>
  (function(){
    const DATA_URL = "/assets/data/itinerary_blocks.json";
    const root = document.getElementById("tripBuilder");
    const statusEl = document.getElementById("builderStatus");
    const daysEl = document.getElementById("tripDays");
    const chipsEl = document.getElementById("interestChips");
    const outEl = document.getElementById("itineraryOutput");

    const btnGenerate = document.getElementById("btnGenerate");
    const btnCopy = document.getElementById("btnCopy");
    const btnEmailToggle = document.getElementById("btnEmailToggle");
    const inviteBox = document.getElementById("inviteBox");
    const btnSendEmail = document.getElementById("btnSendEmail");

    const primaryEmailEl = document.getElementById("primaryEmail");
    const t1EmailEl = document.getElementById("t1Email");
    const t2EmailEl = document.getElementById("t2Email");
    const t3EmailEl = document.getElementById("t3Email");

    let blocks = [];

    function setStatus(msg){
      statusEl.textContent = msg;
    }

    function getSelectedInterests(){
      const checked = Array.from(chipsEl.querySelectorAll("input[type='checkbox']:checked"));
      return checked.map(x => x.value);
    }

    function pick(list, usedIds){
      for (let i = 0; i < list.length; i++){
        const b = list[i];
        if (!usedIds.has(b.id)){
          usedIds.add(b.id);
          return b;
        }
      }
      return list[0] || null;
    }

    function matchesInterest(block, interests){
      const tagSet = new Set((block.tags || []).map(t => String(t).toLowerCase()));
      const cat = String(block.category || "").toLowerCase();
      for (let i = 0; i < interests.length; i++){
        const it = String(interests[i]).toLowerCase();
        if (tagSet.has(it)) return true;
        if (cat === it) return true;
      }
      return false;
    }

    function filterByTime(list, time){
      return list.filter(b => String(b.time_of_day || "") === time);
    }

    function filterByCategory(list, cat){
      const c = String(cat).toLowerCase();
      return list.filter(b => String(b.category || "").toLowerCase() === c);
    }

    function buildItinerary(){
      const days = parseInt(daysEl.value || "3", 10);
      const interests = getSelectedInterests();
      const used = new Set();

      const byInterest = blocks.filter(b => matchesInterest(b, interests));
      const any = blocks.slice();

      const birdingWanted = interests.indexOf("birding") >= 0;
      const waterfallsWanted = interests.indexOf("waterfalls") >= 0;
      const chocolateWanted = interests.indexOf("chocolate") >= 0;
      const nightWanted = interests.indexOf("night") >= 0;
      const adventureWanted = interests.indexOf("adventure") >= 0;
      const relaxedWanted = interests.indexOf("relaxed") >= 0;
      const photoWanted = interests.indexOf("photography") >= 0;

      const birdingBlocks = filterByCategory(blocks, "birding");
      const waterfallBlocks = blocks.filter(b => (b.tags || []).map(String).map(s => s.toLowerCase()).indexOf("waterfalls") >= 0);
      const chocolateBlocks = blocks.filter(b => (b.tags || []).map(String).map(s => s.toLowerCase()).indexOf("chocolate") >= 0);
      const nightBlocks = blocks.filter(b => String(b.time_of_day || "") === "evening");
      const adventureBlocks = blocks.filter(b => (b.tags || []).map(String).map(s => s.toLowerCase()).indexOf("adventure") >= 0);

      const morningList = filterByTime(byInterest.length ? byInterest : any, "early_morning")
        .concat(filterByTime(byInterest.length ? byInterest : any, "morning"));

      const middayList = filterByTime(any, "midday");
      const afternoonList = filterByTime(byInterest.length ? byInterest : any, "afternoon");
      const eveningList = filterByTime(any, "evening");

      const lines = [];
      lines.push("Mindo itinerary draft");
      lines.push("");
      lines.push("Tip: Edit this to match your flight times and hotel.");
      lines.push("");

      for (let d = 1; d <= days; d++){
        lines.push("Day " + d);
        lines.push("");

        let morning = null;

        if (birdingWanted && birdingBlocks.length){
          const tourHalf = birdingBlocks.filter(b => b.id === "birding-tour-half-day");
          const tourFull = birdingBlocks.filter(b => b.id === "birding-tour-full-day");

          if (photoWanted && tourFull.length) morning = pick(tourFull, used);
          if (!morning && (d >= 2) && tourFull.length && days >= 4) morning = pick(tourFull, used);
          if (!morning && tourHalf.length) morning = pick(tourHalf, used);

          if (!morning){
            const bm = birdingBlocks.filter(b => String(b.time_of_day || "") === "early_morning" || String(b.time_of_day || "") === "morning");
            morning = pick(bm, used);
          }
        }

        if (!morning){
          morning = pick(morningList, used);
        }

        if (morning) lines.push("Morning: " + morning.title);

        let midday = null;
        if (relaxedWanted){
          const relax = middayList.filter(b => (b.tags || []).map(String).map(s => s.toLowerCase()).indexOf("relax") >= 0);
          if (relax.length) midday = pick(relax, used);
        }
        if (!midday && chocolateWanted && chocolateBlocks.length){
          midday = pick(chocolateBlocks, used);
        }
        if (!midday){
          midday = pick(middayList, used);
        }
        if (midday) lines.push("Midday: " + midday.title);

        let afternoon = null;
        if (waterfallsWanted && waterfallBlocks.length){
          afternoon = pick(waterfallBlocks, used);
        }
        if (!afternoon && adventureWanted && adventureBlocks.length){
          afternoon = pick(adventureBlocks, used);
        }
        if (!afternoon){
          afternoon = pick(afternoonList, used);
        }
        if (afternoon) lines.push("Afternoon: " + afternoon.title);

        let evening = null;
        if (nightWanted && d >= 2 && nightBlocks.length){
          evening = pick(nightBlocks, used);
        }
        if (!evening && eveningList.length && !relaxedWanted && d === 2){
          evening = pick(eveningList, used);
        }
        if (evening) lines.push("Evening: " + evening.title);

        lines.push("");
      }

      lines.push("Want us to customize this? Message us on WhatsApp: https://wa.me/13054585402");
      outEl.value = lines.join("\n");
      setStatus("Itinerary generated. You can edit it before copying or emailing.");
    }

    function copyItinerary(){
      const txt = outEl.value || "";
      if (!txt.trim()){
        setStatus("Nothing to copy yet. Click Generate itinerary first.");
        return;
      }
      outEl.focus();
      outEl.select();
      try{
        const ok = document.execCommand("copy");
        setStatus(ok ? "Copied to clipboard." : "Copy failed. Select and copy manually.");
      }catch(err){
        setStatus("Copy failed. Select and copy manually.");
      }
      outEl.setSelectionRange(0, 0);
    }

    function toggleEmail(){
      const show = inviteBox.style.display !== "block";
      inviteBox.style.display = show ? "block" : "none";
      if (show) setStatus("Add your email and up to 3 travelers, then click Send email.");
      else setStatus("Email form hidden.");
    }

    function isValidEmail(s){
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(s || "").trim());
    }

    async function sendEmail(){
      const endpoint = (root.getAttribute("data-endpoint") || "").trim();
      if (!endpoint){
        setStatus("Email sending is not enabled yet. Set a web app endpoint in data-endpoint.");
        return;
      }

      const itineraryText = outEl.value || "";
      if (!itineraryText.trim()){
        setStatus("Nothing to email yet. Click Generate itinerary first.");
        return;
      }

      const primaryEmail = (primaryEmailEl.value || "").trim();
      if (!isValidEmail(primaryEmail)){
        setStatus("Please enter a valid email.");
        return;
      }

      const invitees = [t1EmailEl.value, t2EmailEl.value, t3EmailEl.value]
        .map(x => String(x || "").trim())
        .filter(x => x && isValidEmail(x))
        .map(x => ({ first_name:"", last_name:"", email:x }));

      const interests = getSelectedInterests();
      const payload = {
        first_name: "Traveler",
        last_name: "MBW",
        email: primaryEmail,
        trip_days: parseInt(daysEl.value || "3", 10),
        regions: "Mindo",
        experiences: interests.join(", "),
        page_url: location.href,
        user_agent: navigator.userAgent,
        itinerary_text: itineraryText,
        invitees_json: JSON.stringify(invitees)
      };

      setStatus("Sending email...");

      try{
        const res = await fetch(endpoint, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });
        const data = await res.json().catch(() => ({}));
        if (res.ok && data && data.ok){
          setStatus("Sent. Check your inbox (and spam) in a minute.");
        } else {
          setStatus("Send failed. " + (data && (data.error || data.detail) ? (data.error || data.detail) : "Unknown error"));
        }
      }catch(err){
        setStatus("Send failed. Network or endpoint error.");
      }
    }

    async function loadBlocks(){
      try{
        const res = await fetch(DATA_URL, { cache: "no-store" });
        const data = await res.json();
        const arr = data && data.blocks ? data.blocks : [];
        blocks = Array.isArray(arr) ? arr : [];
        if (!blocks.length){
          setStatus("No blocks found. Check " + DATA_URL);
          return;
        }
        setStatus("Ready. Choose your trip length, select interests, then generate.");
      }catch(err){
        setStatus("Could not load blocks. Check " + DATA_URL);
      }
    }

    btnGenerate.addEventListener("click", buildItinerary);
    btnCopy.addEventListener("click", copyItinerary);
    btnEmailToggle.addEventListener("click", toggleEmail);
    btnSendEmail.addEventListener("click", sendEmail);

    loadBlocks();
  })();
  </script>
  <!-- Shared includes + header behavior -->
  <script src="/assets/js/includes.js?v=1" defer></script>
  <script src="/assets/js/site.js?v=1" defer></script>
</body>
</html>Â |oai:code-citation|
